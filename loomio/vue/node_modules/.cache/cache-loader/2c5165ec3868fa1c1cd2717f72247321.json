{"remainingRequest":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js!/home/gustavo/Documents/tese/loomio/vue/src/shared/record_store/record_store.coffee","dependencies":[{"path":"/home/gustavo/Documents/tese/loomio/vue/src/shared/record_store/record_store.coffee","mtime":1706724415812},{"path":"/home/gustavo/Documents/tese/loomio/vue/.babelrc","mtime":1706724415792},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/cache-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js","mtime":1706724500796},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js","mtime":1706724497848}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9waWNrIGZyb20gImxvZGFzaC9waWNrIjsKaW1wb3J0IF9pbnRlcnNlY3Rpb24gZnJvbSAibG9kYXNoL2ludGVyc2VjdGlvbiI7CmltcG9ydCBfZWFjaCBmcm9tICJsb2Rhc2gvZWFjaCI7CmltcG9ydCBfa2V5cyBmcm9tICJsb2Rhc2gva2V5cyI7CmltcG9ydCBfbWFwIGZyb20gImxvZGFzaC9tYXAiOwppbXBvcnQgX2NhbWVsQ2FzZSBmcm9tICJsb2Rhc2gvY2FtZWxDYXNlIjsKaW1wb3J0IF9pc0VtcHR5IGZyb20gImxvZGFzaC9pc0VtcHR5IjsKaW1wb3J0IF9zbmFrZUNhc2UgZnJvbSAibG9kYXNoL3NuYWtlQ2FzZSI7CnZhciBSZWNvcmRTdG9yZTsKaW1wb3J0IFJlY29yZFZpZXcgZnJvbSAnQC9zaGFyZWQvcmVjb3JkX3N0b3JlL3JlY29yZF92aWV3JzsKaW1wb3J0IFJlc3RmdWxDbGllbnQgZnJvbSAnLi9yZXN0ZnVsX2NsaWVudCc7CmltcG9ydCB1dGlscyBmcm9tICdAL3NoYXJlZC9yZWNvcmRfc3RvcmUvdXRpbHMnOwpleHBvcnQgZGVmYXVsdCBSZWNvcmRTdG9yZSA9IGZ1bmN0aW9uICgpIHsKICBjbGFzcyBSZWNvcmRTdG9yZSB7CiAgICBjb25zdHJ1Y3RvcihkYikgewogICAgICB0aGlzLmRiID0gZGI7CiAgICAgIHRoaXMuY29sbGVjdGlvbk5hbWVzID0gW107CiAgICAgIHRoaXMudmlld3MgPSB7fTsKICAgICAgdGhpcy5yZW1vdGUgPSBuZXcgUmVzdGZ1bENsaWVudCgpOwoKICAgICAgdGhpcy5yZW1vdGUub25TdWNjZXNzID0gZGF0YSA9PiB7CiAgICAgICAgdGhpcy5pbXBvcnRKU09OKGRhdGEpOwogICAgICAgIHJldHVybiBkYXRhOwogICAgICB9OwogICAgfQoKICAgIGZldGNoKGFyZ3MpIHsKICAgICAgcmV0dXJuIHRoaXMucmVtb3RlLmZldGNoKGFyZ3MpOwogICAgfQoKICAgIHBvc3QoX3JlZikgewogICAgICBsZXQgewogICAgICAgIHBhdGgsCiAgICAgICAgcGFyYW1zCiAgICAgIH0gPSBfcmVmOwogICAgICByZXR1cm4gdGhpcy5yZW1vdGUucG9zdChwYXRoLCBwYXJhbXMpOwogICAgfQoKICAgIGFkZFJlY29yZHNJbnRlcmZhY2UocmVjb3Jkc0ludGVyZmFjZUNsYXNzKSB7CiAgICAgIHZhciBuYW1lLCByZWNvcmRzSW50ZXJmYWNlOwogICAgICByZWNvcmRzSW50ZXJmYWNlID0gbmV3IHJlY29yZHNJbnRlcmZhY2VDbGFzcyh0aGlzKTsKICAgICAgbmFtZSA9IF9jYW1lbENhc2UocmVjb3Jkc0ludGVyZmFjZS5tb2RlbC5wbHVyYWwpOwogICAgICB0aGlzW25hbWVdID0gcmVjb3Jkc0ludGVyZmFjZTsKICAgICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvbk5hbWVzLnB1c2gobmFtZSk7CiAgICB9CgogICAgaW1wb3J0SlNPTihqc29uKSB7CiAgICAgIHZhciBjb2xsZWN0aW9uczsKICAgICAgY29sbGVjdGlvbnMgPSBfcGljayhqc29uLCBfbWFwKHRoaXMuY29sbGVjdGlvbk5hbWVzLCBfc25ha2VDYXNlKS5jb25jYXQoWydwYXJlbnRfZ3JvdXBzJywgJ3BhcmVudF9ldmVudHMnXSkpOwogICAgICByZXR1cm4gdGhpcy5pbXBvcnRSRUFEWSh1dGlscy5kZXNlcmlhbGl6ZShjb2xsZWN0aW9ucykpOwogICAgfQoKICAgIGltcG9ydFJFQURZKGRhdGEpIHsKICAgICAgaWYgKF9pc0VtcHR5KGRhdGEpKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9IC8vIGhhY2sganVzdCB0byBnZXQgYXJvdW5kIEFNUwoKCiAgICAgIGlmIChkYXRhWydwYXJlbnRHcm91cHMnXSAhPSBudWxsKSB7CiAgICAgICAgX2VhY2goZGF0YVsncGFyZW50R3JvdXBzJ10sIHJlY29yZERhdGEgPT4gewogICAgICAgICAgdGhpcy5ncm91cHMuaW1wb3J0UmVjb3JkKHJlY29yZERhdGEpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChkYXRhWydwYXJlbnRFdmVudHMnXSAhPSBudWxsKSB7CiAgICAgICAgX2VhY2goZGF0YVsncGFyZW50RXZlbnRzJ10sIHJlY29yZERhdGEgPT4gewogICAgICAgICAgdGhpcy5ldmVudHMuaW1wb3J0UmVjb3JkKHJlY29yZERhdGEpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIF9lYWNoKHRoaXMuY29sbGVjdGlvbk5hbWVzLCBuYW1lID0+IHsKICAgICAgICBpZiAoZGF0YVtuYW1lXSAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gX2VhY2goZGF0YVtuYW1lXSwgcmVjb3JkRGF0YSA9PiB7CiAgICAgICAgICAgIHRoaXNbbmFtZV0uaW1wb3J0UmVjb3JkKHJlY29yZERhdGEpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBfZWFjaCh0aGlzLnZpZXdzLCB2aWV3ID0+IHsKICAgICAgICBpZiAoX2ludGVyc2VjdGlvbihfbWFwKHZpZXcuY29sbGVjdGlvbk5hbWVzLCBfY2FtZWxDYXNlKSwgX21hcChfa2V5cyhkYXRhKSwgX2NhbWVsQ2FzZSkpKSB7CiAgICAgICAgICB2aWV3LnF1ZXJ5KHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9CgogICAgdmlldyhfcmVmMikgewogICAgICBsZXQgewogICAgICAgIG5hbWUsCiAgICAgICAgY29sbGVjdGlvbnMsCiAgICAgICAgcXVlcnkKICAgICAgfSA9IF9yZWYyOwoKICAgICAgaWYgKCF0aGlzLnZpZXdzW25hbWVdKSB7CiAgICAgICAgdGhpcy52aWV3c1tuYW1lXSA9IG5ldyBSZWNvcmRWaWV3KHsKICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICByZWNvcmRTdG9yZTogdGhpcywKICAgICAgICAgIGNvbGxlY3Rpb25zOiBjb2xsZWN0aW9ucywKICAgICAgICAgIHF1ZXJ5OiBxdWVyeQogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLnZpZXdzW25hbWVdLnF1ZXJ5KHRoaXMpOwogICAgICByZXR1cm4gdGhpcy52aWV3c1tuYW1lXTsKICAgIH0KCiAgfQoKICA7CiAgUmVjb3JkU3RvcmUucHJvdG90eXBlLmV2ZW50VHlwZU1hcCA9IHsKICAgIEdyb3VwOiAnZ3JvdXBzJywKICAgIERpc2N1c3Npb246ICdkaXNjdXNzaW9ucycsCiAgICBQb2xsOiAncG9sbHMnLAogICAgT3V0Y29tZTogJ291dGNvbWVzJywKICAgIFN0YW5jZTogJ3N0YW5jZXMnLAogICAgQ29tbWVudDogJ2NvbW1lbnRzJywKICAgIENvbW1lbnRWb3RlOiAnY29tbWVudHMnLAogICAgTWVtYmVyc2hpcDogJ21lbWJlcnNoaXBzJywKICAgIE1lbWJlcnNoaXBSZXF1ZXN0OiAnbWVtYmVyc2hpcFJlcXVlc3RzJwogIH07CiAgcmV0dXJuIFJlY29yZFN0b3JlOwp9LmNhbGwodGhpcyk7"},{"version":3,"sources":["/home/gustavo/Documents/tese/loomio/vue/src/shared/record_store/record_store.coffee"],"names":[],"mappings":"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","sourcesContent":["import RecordView from '@/shared/record_store/record_view'\nimport RestfulClient from './restful_client'\nimport utils         from '@/shared/record_store/utils'\nimport { snakeCase, isEmpty, camelCase, map, keys, each, intersection, merge, pick } from 'lodash'\n\nexport default class RecordStore\n  eventTypeMap:\n    Group: 'groups'\n    Discussion: 'discussions'\n    Poll: 'polls'\n    Outcome: 'outcomes'\n    Stance: 'stances'\n    Comment: 'comments'\n    CommentVote: 'comments'\n    Membership: 'memberships'\n    MembershipRequest: 'membershipRequests'\n\n  constructor: (db) ->\n    @db = db\n    @collectionNames = []\n    @views = {}\n    @remote = new RestfulClient\n    @remote.onSuccess = (data) =>\n      @importJSON(data)\n      data\n\n  fetch: (args) ->\n    @remote.fetch(args)\n\n  post: ({path, params}) ->\n    @remote.post(path, params)\n\n  addRecordsInterface: (recordsInterfaceClass) ->\n    recordsInterface = new recordsInterfaceClass(@)\n    name = camelCase(recordsInterface.model.plural)\n    @[name] = recordsInterface\n    @collectionNames.push name\n\n  importJSON: (json) ->\n    collections = pick(json, map(@collectionNames, snakeCase).concat(['parent_groups', 'parent_events']))\n    @importREADY(utils.deserialize(collections))\n\n  importREADY: (data) ->\n    return [] if isEmpty(data)\n\n    # hack just to get around AMS\n    if data['parentGroups']?\n      each data['parentGroups'], (recordData) =>\n        @groups.importRecord(recordData)\n        true\n\n    if data['parentEvents']?\n      each data['parentEvents'], (recordData) =>\n        @events.importRecord(recordData)\n        true\n\n    each @collectionNames, (name) =>\n      if data[name]?\n        each data[name], (recordData) =>\n          @[name].importRecord(recordData)\n          true\n\n    each @views, (view) =>\n      if intersection( map(view.collectionNames, camelCase) , map(keys(data), camelCase) )\n        view.query(@)\n      true\n    data\n\n  view: ({name, collections, query}) ->\n    if !@views[name]\n      @views[name] = new RecordView(name: name, recordStore: @, collections: collections, query: query)\n    @views[name].query(@)\n    @views[name]\n"],"sourceRoot":""}]}