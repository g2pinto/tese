{"remainingRequest":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!/home/gustavo/Documents/tese/loomio/vue/src/components/group/subgroups_panel.vue?vue&type=script&lang=coffee&","dependencies":[{"path":"/home/gustavo/Documents/tese/loomio/vue/src/components/group/subgroups_panel.vue","mtime":1706724415800},{"path":"/home/gustavo/Documents/tese/loomio/vue/.babelrc","mtime":1706724415792},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/cache-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js","mtime":1706724500796},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/@vue/vue-loader-v15/lib/index.js","mtime":1706724499784}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zb21lIGZyb20gImxvZGFzaC9zb21lIjsKaW1wb3J0IF9kZWJvdW5jZSBmcm9tICJsb2Rhc2gvZGVib3VuY2UiOwppbXBvcnQgUmVjb3JkcyBmcm9tICdAL3NoYXJlZC9zZXJ2aWNlcy9yZWNvcmRzJzsKaW1wb3J0IFNlc3Npb24gZnJvbSAnQC9zaGFyZWQvc2VydmljZXMvc2Vzc2lvbic7CmltcG9ydCBFdmVudEJ1cyBmcm9tICdAL3NoYXJlZC9zZXJ2aWNlcy9ldmVudF9idXMnOwppbXBvcnQgQWJpbGl0eVNlcnZpY2UgZnJvbSAnQC9zaGFyZWQvc2VydmljZXMvYWJpbGl0eV9zZXJ2aWNlJzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIGdyb3VwOiBudWxsLAogICAgICBsb2FkaW5nOiB0cnVlCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gKCkgewogICAgdGhpcy5vblF1ZXJ5SW5wdXQgPSBfZGVib3VuY2UodmFsID0+IHsKICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlci5yZXBsYWNlKHRoaXMubWVyZ2VRdWVyeSh7CiAgICAgICAgcTogdmFsCiAgICAgIH0pKTsKICAgIH0sIDUwMCk7CiAgICByZXR1cm4gUmVjb3Jkcy5ncm91cHMuZmluZE9yRmV0Y2godGhpcy4kcm91dGUucGFyYW1zLmtleSkudGhlbihncm91cCA9PiB7CiAgICAgIHRoaXMuZ3JvdXAgPSBncm91cDsKICAgICAgRXZlbnRCdXMuJGVtaXQoJ2N1cnJlbnRDb21wb25lbnQnLCB7CiAgICAgICAgcGFnZTogJ2dyb3VwUGFnZScsCiAgICAgICAgdGl0bGU6IHRoaXMuZ3JvdXAubmFtZSwKICAgICAgICBncm91cDogdGhpcy5ncm91cAogICAgICB9KTsKICAgICAgUmVjb3Jkcy5ncm91cHMuZmV0Y2hCeVBhcmVudCh0aGlzLmdyb3VwKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICByZXR1cm4gRXZlbnRCdXMuJGVtaXQoJ3N1Ymdyb3Vwc0xvYWRlZCcsIHRoaXMuZ3JvdXApOwogICAgICB9KTsKICAgICAgdGhpcy53YXRjaFJlY29yZHMoewogICAgICAgIGNvbGxlY3Rpb25zOiBbJ21lbWJlcnNoaXBzJywgJ2dyb3VwcyddLAogICAgICAgIHF1ZXJ5OiB0aGlzLmZpbmRSZWNvcmRzCiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpcy5maW5kUmVjb3JkcygpOwogICAgfSk7CiAgfSwKICBjb21wdXRlZDogewogICAgY2FuQ3JlYXRlU3ViZ3JvdXBzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBBYmlsaXR5U2VydmljZS5jYW5DcmVhdGVTdWJncm91cHModGhpcy5ncm91cCk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBmaW5kUmVjb3JkczogZnVuY3Rpb24gKCkgewogICAgICB2YXIgY2hhaW4sIG1lbWJlcklkcywgdmlzaWJsZUlkczsKICAgICAgbWVtYmVySWRzID0gUmVjb3Jkcy5tZW1iZXJzaGlwcy5maW5kKHsKICAgICAgICB1c2VySWQ6IFNlc3Npb24udXNlcigpLmlkCiAgICAgIH0pLm1hcChmdW5jdGlvbiAobSkgewogICAgICAgIHJldHVybiBtLmdyb3VwSWQ7CiAgICAgIH0pOwogICAgICB2aXNpYmxlSWRzID0gUmVjb3Jkcy5ncm91cHMuY29sbGVjdGlvbi5jaGFpbigpLmZpbmQoewogICAgICAgIHBhcmVudElkOiB0aGlzLmdyb3VwLmlkCiAgICAgIH0pLmZpbmQoewogICAgICAgIGdyb3VwUHJpdmFjeTogewogICAgICAgICAgJGluOiBbJ2Nsb3NlZCcsICdvcGVuJ10KICAgICAgICB9CiAgICAgIH0pLmRhdGEoKS5tYXAoZnVuY3Rpb24gKGcpIHsKICAgICAgICByZXR1cm4gZy5pZDsKICAgICAgfSk7CiAgICAgIGNoYWluID0gUmVjb3Jkcy5ncm91cHMuY29sbGVjdGlvbi5jaGFpbigpLmZpbmQoewogICAgICAgIHBhcmVudElkOiB0aGlzLmdyb3VwLmlkLAogICAgICAgIGlkOiB7CiAgICAgICAgICAkaW46IG1lbWJlcklkcy5jb25jYXQodmlzaWJsZUlkcykKICAgICAgICB9CiAgICAgIH0pLnNpbXBsZXNvcnQoJ25hbWUnKTsKCiAgICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS5xKSB7CiAgICAgICAgY2hhaW4gPSBjaGFpbi53aGVyZShncm91cCA9PiB7CiAgICAgICAgICByZXR1cm4gX3NvbWUoW2dyb3VwLm5hbWUsIGdyb3VwLmRlc2NyaXB0aW9uXSwgZmllbGQgPT4gewogICAgICAgICAgICByZXR1cm4gUmVnRXhwKHRoaXMuJHJvdXRlLnF1ZXJ5LnEsICJpIikudGVzdChmaWVsZCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuc3ViZ3JvdXBzID0gY2hhaW4uZGF0YSgpOwogICAgfSwKICAgIHN0YXJ0U3ViZ3JvdXA6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIEV2ZW50QnVzLiRlbWl0KCdvcGVuTW9kYWwnLCB7CiAgICAgICAgY29tcG9uZW50OiAnR3JvdXBOZXdGb3JtJywKICAgICAgICBwcm9wczogewogICAgICAgICAgZ3JvdXA6IFJlY29yZHMuZ3JvdXBzLmJ1aWxkKHsKICAgICAgICAgICAgcGFyZW50SWQ6IHRoaXMuZ3JvdXAuaWQKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzdHJpcERlc2NyaXB0aW9uOiBmdW5jdGlvbiAoZGVzY3JpcHRpb24pIHsKICAgICAgcmV0dXJuIChkZXNjcmlwdGlvbiB8fCAnJykucmVwbGFjZSgvPFtePl0qPj8vZ20sICcnKTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAnJHJvdXRlLnF1ZXJ5JzogJ2ZpbmRSZWNvcmRzJwogIH0KfTs="},{"version":3,"sources":["/home/gustavo/Documents/tese/loomio/vue/src/components/group/subgroups_panel.vue"],"names":[],"mappings":"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","sourcesContent":["\nimport Records        from '@/shared/services/records'\nimport Session        from '@/shared/services/session'\nimport EventBus       from '@/shared/services/event_bus'\nimport AbilityService from '@/shared/services/ability_service'\nimport { debounce, some, every } from 'lodash'\n\nexport default\n  data: ->\n    group: null\n    loading: true\n\n  created: ->\n    @onQueryInput = debounce (val) =>\n      @$router.replace(@mergeQuery(q: val))\n    , 500\n\n    Records.groups.findOrFetch(@$route.params.key).then (group) =>\n      @group = group\n\n      EventBus.$emit 'currentComponent',\n        page: 'groupPage'\n        title: @group.name\n        group: @group\n\n      Records.groups.fetchByParent(@group).then =>\n        @loading = false\n        EventBus.$emit 'subgroupsLoaded', @group\n\n      @watchRecords\n        collections: ['memberships', 'groups']\n        query: @findRecords\n\n      @findRecords()\n\n  computed:\n    canCreateSubgroups: ->\n      AbilityService.canCreateSubgroups(@group)\n\n  methods:\n    findRecords: ->\n      memberIds = Records.memberships.find(userId: Session.user().id).map (m) -> m.groupId\n      visibleIds = Records.groups.collection.chain().\n                     find(parentId: @group.id).\n                     find(groupPrivacy: {$in: ['closed', 'open']}).data().map (g) -> g.id\n\n      chain = Records.groups.collection.chain().\n                     find(parentId: @group.id, id: {$in: memberIds.concat(visibleIds)}).\n                     simplesort('name')\n\n      if @$route.query.q\n        chain = chain.where (group) =>\n          some [group.name, group.description], (field) =>\n            RegExp(@$route.query.q, \"i\").test(field)\n\n      @subgroups = chain.data()\n\n    startSubgroup: ->\n      EventBus.$emit('openModal',\n                      component: 'GroupNewForm',\n                      props: {\n                        group: Records.groups.build(parentId: @group.id)\n                      })\n\n\n    stripDescription: (description) -> (description || '').replace(///<[^>]*>?///gm, '')\n\n  watch:\n    '$route.query': 'findRecords'\n"],"sourceRoot":""}]}