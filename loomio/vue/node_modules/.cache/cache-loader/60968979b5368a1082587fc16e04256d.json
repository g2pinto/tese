{"remainingRequest":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js!/home/gustavo/Documents/tese/loomio/vue/src/shared/record_store/restful_client.coffee","dependencies":[{"path":"/home/gustavo/Documents/tese/loomio/vue/src/shared/record_store/restful_client.coffee","mtime":1706724415812},{"path":"/home/gustavo/Documents/tese/loomio/vue/.babelrc","mtime":1706724415792},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/cache-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js","mtime":1706724500796},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js","mtime":1706724497848}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9pc05pbCBmcm9tICJsb2Rhc2gvaXNOaWwiOwppbXBvcnQgX3BpY2tCeSBmcm9tICJsb2Rhc2gvcGlja0J5IjsKaW1wb3J0IF9kZWZhdWx0cyBmcm9tICJsb2Rhc2gvZGVmYXVsdHMiOwppbXBvcnQgX2lzU3RyaW5nIGZyb20gImxvZGFzaC9pc1N0cmluZyI7CmltcG9ydCBfY29tcGFjdCBmcm9tICJsb2Rhc2gvY29tcGFjdCI7CmltcG9ydCBfc25ha2VDYXNlIGZyb20gImxvZGFzaC9zbmFrZUNhc2UiOwppbXBvcnQgX29taXRCeSBmcm9tICJsb2Rhc2gvb21pdEJ5IjsKdmFyIFJlc3RmdWxDbGllbnQsIGdldENTUkY7CmltcG9ydCB7IGVuY29kZVBhcmFtcyB9IGZyb20gJ0Avc2hhcmVkL2hlbHBlcnMvZW5jb2RlX3BhcmFtcyc7CgpnZXRDU1JGID0gZnVuY3Rpb24gKCkgewogIHZhciByZWY7CiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCgoKHJlZiA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCgnKF58OylcXHMqJyArICdjc3JmdG9rZW4nICsgJ1xccyo9XFxzKihbXjtdKyknKSkgIT0gbnVsbCA/IHJlZi5wb3AoKSA6IHZvaWQgMCkgfHwgJycpOwp9OwoKZXhwb3J0IGRlZmF1bHQgUmVzdGZ1bENsaWVudCA9IGZ1bmN0aW9uICgpIHsKICBjbGFzcyBSZXN0ZnVsQ2xpZW50IHsKICAgIG9uUHJlcGFyZShyZXF1ZXN0KSB7CiAgICAgIHJldHVybiByZXF1ZXN0OwogICAgfQoKICAgIG9uQ2xlYW51cChyZXNwb25zZSkgewogICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9CgogICAgb25SZXNwb25zZShyZXNwb25zZSkgewogICAgICBpZiAocmVzcG9uc2Uub2spIHsKICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4odGhpcy5vblN1Y2Nlc3MpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLm9uRmFpbHVyZShyZXNwb25zZSk7CiAgICAgIH0KICAgIH0KCiAgICBvblN1Y2Nlc3MoZGF0YSkgewogICAgICByZXR1cm4gZGF0YTsKICAgIH0KCiAgICBvbkZhaWx1cmUocmVzcG9uc2UpIHsKICAgICAgaWYgKHJlc3BvbnNlLmpzb24pIHsKICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIGRhdGEuc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzOwogICAgICAgICAgZGF0YS5zdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdHVzVGV4dDsKICAgICAgICAgIGRhdGEub2sgPSByZXNwb25zZS5vazsKICAgICAgICAgIHRocm93IGRhdGE7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgcmVzcG9uc2U7CiAgICAgIH0KICAgIH0KCiAgICBvblVwbG9hZFN1Y2Nlc3MocmVzcG9uc2UpIHsKICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBsZXQgcmVzb3VyY2VQbHVyYWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG51bGw7CiAgICAgIHRoaXMub25SZXNwb25zZSA9IHRoaXMub25SZXNwb25zZS5iaW5kKHRoaXMpOwogICAgICB0aGlzLmRlZmF1bHRQYXJhbXMudW5zdWJzY3JpYmVfdG9rZW4gPSBuZXcgVVJMU2VhcmNoUGFyYW1zKGxvY2F0aW9uLnNlYXJjaCkuZ2V0KCd1bnN1YnNjcmliZV90b2tlbicpOwogICAgICB0aGlzLmRlZmF1bHRQYXJhbXMubWVtYmVyc2hpcF90b2tlbiA9IG5ldyBVUkxTZWFyY2hQYXJhbXMobG9jYXRpb24uc2VhcmNoKS5nZXQoJ21lbWJlcnNoaXBfdG9rZW4nKTsKICAgICAgdGhpcy5kZWZhdWx0UGFyYW1zLnN0YW5jZV90b2tlbiA9IG5ldyBVUkxTZWFyY2hQYXJhbXMobG9jYXRpb24uc2VhcmNoKS5nZXQoJ3N0YW5jZV90b2tlbicpOwogICAgICB0aGlzLmRlZmF1bHRQYXJhbXMuZGlzY3Vzc2lvbl9yZWFkZXJfdG9rZW4gPSBuZXcgVVJMU2VhcmNoUGFyYW1zKGxvY2F0aW9uLnNlYXJjaCkuZ2V0KCdkaXNjdXNzaW9uX3JlYWRlcl90b2tlbicpOwogICAgICB0aGlzLmRlZmF1bHRQYXJhbXMgPSBfb21pdEJ5KHRoaXMuZGVmYXVsdFBhcmFtcywgX2lzTmlsKTsKICAgICAgdGhpcy5wcm9jZXNzaW5nID0gW107CgogICAgICBpZiAocmVzb3VyY2VQbHVyYWwpIHsKICAgICAgICB0aGlzLnJlc291cmNlUGx1cmFsID0gX3NuYWtlQ2FzZShyZXNvdXJjZVBsdXJhbCk7CiAgICAgIH0KICAgIH0KCiAgICBidWlsZFVybChwYXRoLCBwYXJhbXMpIHsKICAgICAgcGF0aCA9IF9jb21wYWN0KFt0aGlzLmFwaVByZWZpeCwgdGhpcy5yZXNvdXJjZVBsdXJhbCwgcGF0aF0pLmpvaW4oJy8nKTsKCiAgICAgIGlmIChwYXJhbXMgPT0gbnVsbCkgewogICAgICAgIHJldHVybiBwYXRoOwogICAgICB9CgogICAgICByZXR1cm4gcGF0aCArICI/IiArIGVuY29kZVBhcmFtcyhwYXJhbXMpOwogICAgfQoKICAgIG1lbWJlclBhdGgoaWQsIGFjdGlvbikgewogICAgICByZXR1cm4gX2NvbXBhY3QoW2lkLCBhY3Rpb25dKS5qb2luKCcvJyk7CiAgICB9CgogICAgZmV0Y2hCeUlkKGlkKSB7CiAgICAgIGxldCBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgICByZXR1cm4gdGhpcy5nZXRNZW1iZXIoaWQsICcnLCBwYXJhbXMpOwogICAgfQoKICAgIGZldGNoKF9yZWYpIHsKICAgICAgbGV0IHsKICAgICAgICBwYXJhbXMsCiAgICAgICAgcGF0aAogICAgICB9ID0gX3JlZjsKICAgICAgcmV0dXJuIHRoaXMuZ2V0KHBhdGggfHwgJycsIHBhcmFtcyk7CiAgICB9CgogICAgcG9zdChwYXRoLCBwYXJhbXMpIHsKICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCh0aGlzLmJ1aWxkVXJsKHBhdGgpLCAnUE9TVCcsIHRoaXMucGFyYW1zRm9yKHBhcmFtcykpOwogICAgfQoKICAgIHBhdGNoKHBhdGgsIHBhcmFtcykgewogICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHRoaXMuYnVpbGRVcmwocGF0aCksICdQQVRDSCcsIHRoaXMucGFyYW1zRm9yKHBhcmFtcykpOwogICAgfQoKICAgIGRlbGV0ZShwYXRoLCBwYXJhbXMpIHsKICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCh0aGlzLmJ1aWxkVXJsKHBhdGgpLCAnREVMRVRFJywgdGhpcy5wYXJhbXNGb3IocGFyYW1zKSk7CiAgICB9IC8vIE5COiBnZXQgcmVxdWVzdHMgcGxhY2UgdGhlaXIgcGFyYW1zIGludG8gdGhlIHF1ZXJ5IHN0cmluZywgcmF0aGVyIHRoYW4gdGhlIHJlcXVlc3QgYm9keQoKCiAgICBnZXQocGF0aCwgcGFyYW1zKSB7CiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QodGhpcy5idWlsZFVybChwYXRoLCB0aGlzLnBhcmFtc0ZvcihwYXJhbXMpKSwgJ0dFVCcpOwogICAgfQoKICAgIHJlcXVlc3QocGF0aCwgbWV0aG9kKSB7CiAgICAgIGxldCBib2R5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsKICAgICAgdmFyIG9wdHM7CiAgICAgIG9wdHMgPSB7CiAgICAgICAgbWV0aG9kOiBtZXRob2QsCiAgICAgICAgY3JlZGVudGlhbHM6ICdzYW1lLW9yaWdpbicsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICdYLUNTUkYtVE9LRU4nOiBnZXRDU1JGKCkKICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpCiAgICAgIH07CgogICAgICBpZiAobWV0aG9kID09PSAnR0VUJykgewogICAgICAgIGRlbGV0ZSBvcHRzLmJvZHk7CiAgICAgIH0KCiAgICAgIHRoaXMub25QcmVwYXJlKCk7CiAgICAgIHJldHVybiBmZXRjaChwYXRoLCBvcHRzKS50aGVuKHRoaXMub25SZXNwb25zZSwgdGhpcy5vbkZhaWx1cmUpLmZpbmFsbHkodGhpcy5vbkNsZWFudXApOwogICAgfQoKICAgIHBvc3RNZW1iZXIoa2V5T3JJZCwgYWN0aW9uLCBwYXJhbXMpIHsKICAgICAgcmV0dXJuIHRoaXMucG9zdCh0aGlzLm1lbWJlclBhdGgoa2V5T3JJZCwgYWN0aW9uKSwgcGFyYW1zKTsKICAgIH0KCiAgICBwYXRjaE1lbWJlcihrZXlPcklkLCBhY3Rpb24sIHBhcmFtcykgewogICAgICByZXR1cm4gdGhpcy5wYXRjaCh0aGlzLm1lbWJlclBhdGgoa2V5T3JJZCwgYWN0aW9uKSwgcGFyYW1zKTsKICAgIH0KCiAgICBnZXRNZW1iZXIoa2V5T3JJZCkgewogICAgICBsZXQgYWN0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnJzsKICAgICAgbGV0IHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwogICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5tZW1iZXJQYXRoKGtleU9ySWQsIGFjdGlvbiksIHBhcmFtcyk7CiAgICB9CgogICAgY3JlYXRlKHBhcmFtcykgewogICAgICByZXR1cm4gdGhpcy5wb3N0KCcnLCBwYXJhbXMpOwogICAgfQoKICAgIHVwZGF0ZShpZCwgcGFyYW1zKSB7CiAgICAgIHJldHVybiB0aGlzLnBhdGNoKGlkLCBwYXJhbXMpOwogICAgfQoKICAgIGRlc3Ryb3koaWQsIHBhcmFtcykgewogICAgICByZXR1cm4gdGhpcy5kZWxldGUoaWQsIHBhcmFtcyk7CiAgICB9CgogICAgZGlzY2FyZChpZCwgcGFyYW1zKSB7CiAgICAgIHJldHVybiB0aGlzLmRlbGV0ZShpZCArICcvZGlzY2FyZCcsIHBhcmFtcyk7CiAgICB9CgogICAgdW5kaXNjYXJkKGlkLCBwYXJhbXMpIHsKICAgICAgcmV0dXJuIHRoaXMucG9zdChpZCArICcvdW5kaXNjYXJkJywgcGFyYW1zKTsKICAgIH0KCiAgICB1cGxvYWQocGF0aCwgZmlsZSkgewogICAgICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICAgIGxldCBvblByb2dyZXNzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CgogICAgICBpZiAoIWZpbGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgdmFyIGRhdGE7CiAgICAgICAgZGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIGRhdGEuYXBwZW5kKG9wdGlvbnMuZmlsZUZpZWxkIHx8ICdmaWxlJywgZmlsZSk7CiAgICAgICAgZGF0YS5hcHBlbmQob3B0aW9ucy5maWxlbmFtZUZpZWxkIHx8ICdmaWxlbmFtZScsIGZpbGUubmFtZS5yZXBsYWNlKC9bXmEtejAtOV9cLVwuXS9naSwgJ18nKSk7CiAgICAgICAgdGhpcy5jdXJyZW50VXBsb2FkID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgdGhpcy5jdXJyZW50VXBsb2FkLm9wZW4oJ1BPU1QnLCB0aGlzLmJ1aWxkVXJsKHBhdGgpLCB0cnVlKTsKICAgICAgICB0aGlzLmN1cnJlbnRVcGxvYWQuc2V0UmVxdWVzdEhlYWRlcignWC1DU1JGLVRPS0VOJywgZ2V0Q1NSRigpKTsKICAgICAgICB0aGlzLmN1cnJlbnRVcGxvYWQucmVzcG9uc2VUeXBlID0gJ2pzb24nOwogICAgICAgIHRoaXMuY3VycmVudFVwbG9hZC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4gewogICAgICAgICAgaWYgKHRoaXMuY3VycmVudFVwbG9hZC5zdGF0dXMgPj0gMjAwICYmIHRoaXMuY3VycmVudFVwbG9hZC5zdGF0dXMgPCAzMDApIHsKICAgICAgICAgICAgaWYgKF9pc1N0cmluZyh0aGlzLmN1cnJlbnRVcGxvYWQucmVzcG9uc2UpKSB7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXBsb2FkLnJlc3BvbnNlID0gSlNPTi5wYXJzZSh0aGlzLmN1cnJlbnRVcGxvYWQucmVzcG9uc2UpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLm9uVXBsb2FkU3VjY2Vzcyh0aGlzLmN1cnJlbnRVcGxvYWQucmVzcG9uc2UpOwogICAgICAgICAgICByZXNvbHZlKHRoaXMuY3VycmVudFVwbG9hZC5yZXNwb25zZSk7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRVcGxvYWQgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAob25Qcm9ncmVzcykgewogICAgICAgICAgdGhpcy5jdXJyZW50VXBsb2FkLnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIG9uUHJvZ3Jlc3MpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jdXJyZW50VXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgcmVqZWN0KTsKICAgICAgICB0aGlzLmN1cnJlbnRVcGxvYWQuYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCByZWplY3QpOwogICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRVcGxvYWQuc2VuZChkYXRhKTsKICAgICAgfSk7CiAgICB9CgogICAgYWJvcnQoKSB7CiAgICAgIGlmICh0aGlzLmN1cnJlbnRVcGxvYWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50VXBsb2FkLmFib3J0KCk7CiAgICAgIH0KICAgIH0KCiAgICBwYXJhbXNGb3IocGFyYW1zKSB7CiAgICAgIHJldHVybiBfZGVmYXVsdHMoe30sIHRoaXMuZGVmYXVsdFBhcmFtcywgX3BpY2tCeShwYXJhbXMsIGZ1bmN0aW9uICh2KSB7CiAgICAgICAgcmV0dXJuICFfaXNOaWwodik7CiAgICAgIH0pKTsKICAgIH0KCiAgfQoKICA7CiAgUmVzdGZ1bENsaWVudC5wcm90b3R5cGUuZGVmYXVsdFBhcmFtcyA9IHt9OwogIFJlc3RmdWxDbGllbnQucHJvdG90eXBlLmN1cnJlbnRVcGxvYWQgPSBudWxsOwogIFJlc3RmdWxDbGllbnQucHJvdG90eXBlLmFwaVByZWZpeCA9ICIvYXBpL3YxIjsKICByZXR1cm4gUmVzdGZ1bENsaWVudDsKfS5jYWxsKHRoaXMpOw=="},{"version":3,"sources":["/home/gustavo/Documents/tese/loomio/vue/src/shared/record_store/restful_client.coffee"],"names":[],"mappings":"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","sourcesContent":["import { encodeParams } from '@/shared/helpers/encode_params'\nimport { omitBy, snakeCase, compact, isString, defaults, pickBy, isNil, identity } from 'lodash'\n\ngetCSRF = ->\n  decodeURIComponent document.cookie.match('(^|;)\\\\s*' + 'csrftoken' + '\\\\s*=\\\\s*([^;]+)')?.pop() || ''\n\nexport default class RestfulClient\n  defaultParams: {}\n  currentUpload: null\n  apiPrefix: \"/api/v1\"\n\n  onPrepare: (request)  -> request\n  onCleanup: (response) -> response\n  onResponse: (response) =>\n    if response.ok\n      response.json().then @onSuccess\n    else\n      @onFailure(response)\n\n  onSuccess: (data) -> data\n\n  onFailure: (response) ->\n    if response.json\n      response.json().then (data) ->\n        data.status = response.status\n        data.statusText = response.statusText\n        data.ok = response.ok\n        throw data\n    else\n      throw response\n\n\n  onUploadSuccess: (response) -> response\n\n  constructor: (resourcePlural = null) ->\n    @defaultParams.unsubscribe_token = new URLSearchParams(location.search).get('unsubscribe_token')\n    @defaultParams.membership_token = new URLSearchParams(location.search).get('membership_token')\n    @defaultParams.stance_token = new URLSearchParams(location.search).get('stance_token')\n    @defaultParams.discussion_reader_token = new URLSearchParams(location.search).get('discussion_reader_token')\n    @defaultParams = omitBy(@defaultParams, isNil)\n    @processing = []\n    @resourcePlural = snakeCase(resourcePlural) if resourcePlural\n\n  buildUrl: (path, params) ->\n    path = compact([@apiPrefix, @resourcePlural, path]).join('/')\n    return path unless params?\n    path + \"?\" + encodeParams(params)\n\n  memberPath: (id, action) ->\n    compact([id, action]).join('/')\n\n  fetchById: (id, params = {}) ->\n    @getMember(id, '', params)\n\n  fetch: ({params, path}) ->\n    @get(path or '', params)\n\n  post: (path, params) ->\n    @request @buildUrl(path), 'POST', @paramsFor(params)\n\n  patch: (path, params) ->\n    @request @buildUrl(path), 'PATCH', @paramsFor(params)\n\n  delete: (path, params) ->\n    @request @buildUrl(path), 'DELETE', @paramsFor(params)\n\n  # NB: get requests place their params into the query string, rather than the request body\n  get: (path, params) ->\n    @request @buildUrl(path, @paramsFor(params)), 'GET'\n\n  request: (path, method, body = {}) ->\n    opts =\n      method: method\n      credentials: 'same-origin'\n      headers: \n        'Content-Type': 'application/json'\n        'X-CSRF-TOKEN': getCSRF()\n      body: JSON.stringify(body)\n    delete opts.body if method == 'GET'\n    @onPrepare()\n    fetch(path, opts)\n    .then(@onResponse, @onFailure)\n    .finally(@onCleanup)\n\n  postMember: (keyOrId, action, params) ->\n    @post(@memberPath(keyOrId, action), params)\n\n  patchMember: (keyOrId, action, params) ->\n    @patch(@memberPath(keyOrId, action), params)\n\n  getMember: (keyOrId, action = '', params) ->\n    @get(@memberPath(keyOrId, action), params)\n\n  create: (params) ->\n    @post('', params)\n\n  update: (id, params) ->\n    @patch(id, params)\n\n  destroy: (id, params) ->\n    @delete(id, params)\n\n  discard: (id, params) ->\n    @delete(id+'/discard', params)\n\n  undiscard: (id, params) ->\n    @post(id+'/undiscard', params)\n\n  upload: (path, file, options = {}, onProgress) ->\n    return unless file\n    new Promise (resolve, reject) =>\n      data = new FormData()\n      data.append(options.fileField     || 'file',     file)\n      data.append(options.filenameField || 'filename', file.name.replace(/[^a-z0-9_\\-\\.]/gi, '_'))\n\n      @currentUpload = new XMLHttpRequest()\n      @currentUpload.open('POST', @buildUrl(path), true)\n      @currentUpload.setRequestHeader('X-CSRF-TOKEN', getCSRF())\n      @currentUpload.responseType = 'json'\n      @currentUpload.addEventListener 'load', =>\n        if (@currentUpload.status >= 200 && @currentUpload.status < 300)\n          @currentUpload.response = JSON.parse(@currentUpload.response) if isString(@currentUpload.response)\n          @onUploadSuccess(@currentUpload.response)\n          resolve(@currentUpload.response)\n          @currentUpload = null\n      @currentUpload.upload.addEventListener('progress', onProgress) if onProgress\n      @currentUpload.addEventListener('error', reject)\n      @currentUpload.addEventListener('abort', reject)\n      @currentUpload.send(data)\n\n  abort: ->\n    @currentUpload.abort() if @currentUpload\n\n  paramsFor: (params) ->\n    defaults({}, @defaultParams, pickBy(params, (v) -> !isNil(v)))\n"],"sourceRoot":""}]}