{"remainingRequest":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js!/home/gustavo/Documents/tese/loomio/vue/src/shared/services/thread_filter.coffee","dependencies":[{"path":"/home/gustavo/Documents/tese/loomio/vue/src/shared/services/thread_filter.coffee","mtime":1706724415812},{"path":"/home/gustavo/Documents/tese/loomio/vue/.babelrc","mtime":1706724415792},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/cache-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js","mtime":1706724500796},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js","mtime":1706724497848}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jb21wYWN0IGZyb20gImxvZGFzaC9jb21wYWN0IjsKaW1wb3J0IF9lYWNoIGZyb20gImxvZGFzaC9lYWNoIjsKaW1wb3J0IFNlc3Npb24gZnJvbSAnQC9zaGFyZWQvc2VydmljZXMvc2Vzc2lvbic7CmltcG9ydCBSZWNvcmRzIGZyb20gJ0Avc2hhcmVkL3NlcnZpY2VzL3JlY29yZHMnOwppbXBvcnQgeyBzdWJXZWVrcyB9IGZyb20gJ2RhdGUtZm5zJzsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKG9wdGlvbnMpIHsKICB2YXIgY2hhaW47CiAgY2hhaW4gPSBSZWNvcmRzLmRpc2N1c3Npb25zLmNvbGxlY3Rpb24uY2hhaW4oKTsKICBjaGFpbiA9IGNoYWluLmZpbmQoewogICAgZGlzY2FyZGVkQXQ6IG51bGwKICB9KTsKCiAgaWYgKG9wdGlvbnMuZ3JvdXApIHsKICAgIGNoYWluID0gY2hhaW4uZmluZCh7CiAgICAgIGdyb3VwSWQ6IHsKICAgICAgICAkaW46IG9wdGlvbnMuZ3JvdXAub3JnYW5pc2F0aW9uSWRzKCkKICAgICAgfQogICAgfSk7CiAgfQoKICBpZiAob3B0aW9ucy5mcm9tKSB7CiAgICBjaGFpbiA9IGNoYWluLmZpbmQoewogICAgICBsYXN0QWN0aXZpdHlBdDogewogICAgICAgICRndDogb3B0aW9ucy5mcm9tCiAgICAgIH0KICAgIH0pOwogIH0KCiAgaWYgKG9wdGlvbnMudG8pIHsKICAgIGNoYWluID0gY2hhaW4uZmluZCh7CiAgICAgIGxhc3RBY3Rpdml0eUF0OiB7CiAgICAgICAgJGx0OiBvcHRpb25zLnRvCiAgICAgIH0KICAgIH0pOwogIH0KCiAgaWYgKG9wdGlvbnMuaWRzKSB7CiAgICBjaGFpbiA9IGNoYWluLmZpbmQoewogICAgICBpZDogewogICAgICAgICRpbjogb3B0aW9ucy5pZHMKICAgICAgfQogICAgfSk7CiAgfSBlbHNlIHsKICAgIF9lYWNoKF9jb21wYWN0KFtdLmNvbmNhdChvcHRpb25zLmZpbHRlcnMpKSwgZnVuY3Rpb24gKGZpbHRlcikgewogICAgICB2YXIgdXNlckdyb3VwSWRzOwogICAgICByZXR1cm4gY2hhaW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgc3dpdGNoIChmaWx0ZXIpIHsKICAgICAgICAgIGNhc2UgJ3Nob3dfcmVjZW50JzoKICAgICAgICAgICAgcmV0dXJuIGNoYWluLmZpbmQoewogICAgICAgICAgICAgIGxhc3RBY3Rpdml0eUF0OiB7CiAgICAgICAgICAgICAgICAkZ3Q6IHN1YldlZWtzKG5ldyBEYXRlKCksIDYpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlICdzaG93X3VucmVhZCc6CiAgICAgICAgICAgIHJldHVybiBjaGFpbi53aGVyZShmdW5jdGlvbiAodGhyZWFkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRocmVhZC5pc1VucmVhZCgpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlICdoaWRlX3VucmVhZCc6CiAgICAgICAgICAgIHJldHVybiBjaGFpbi53aGVyZShmdW5jdGlvbiAodGhyZWFkKSB7CiAgICAgICAgICAgICAgcmV0dXJuICF0aHJlYWQuaXNVbnJlYWQoKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAnc2hvd19kaXNtaXNzZWQnOgogICAgICAgICAgICByZXR1cm4gY2hhaW4ud2hlcmUoZnVuY3Rpb24gKHRocmVhZCkgewogICAgICAgICAgICAgIHJldHVybiB0aHJlYWQuaXNEaXNtaXNzZWQoKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAnaGlkZV9kaXNtaXNzZWQnOgogICAgICAgICAgICByZXR1cm4gY2hhaW4ud2hlcmUoZnVuY3Rpb24gKHRocmVhZCkgewogICAgICAgICAgICAgIHJldHVybiAhdGhyZWFkLmlzRGlzbWlzc2VkKCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgJ3Nob3dfY2xvc2VkJzoKICAgICAgICAgICAgcmV0dXJuIGNoYWluLndoZXJlKGZ1bmN0aW9uICh0aHJlYWQpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhyZWFkLmNsb3NlZEF0ICE9IG51bGw7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgJ3Nob3dfb3BlbmVkJzoKICAgICAgICAgICAgcmV0dXJuIGNoYWluLmZpbmQoewogICAgICAgICAgICAgIGNsb3NlZEF0OiBudWxsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgJ3Nob3dfcGlubmVkJzoKICAgICAgICAgICAgcmV0dXJuIGNoYWluLmZpbmQoewogICAgICAgICAgICAgIHBpbm5lZDogdHJ1ZQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlICdoaWRlX3Bpbm5lZCc6CiAgICAgICAgICAgIHJldHVybiBjaGFpbi5maW5kKHsKICAgICAgICAgICAgICBwaW5uZWQ6IGZhbHNlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgJ3Nob3dfbXV0ZWQnOgogICAgICAgICAgICByZXR1cm4gY2hhaW4ud2hlcmUoZnVuY3Rpb24gKHRocmVhZCkgewogICAgICAgICAgICAgIHJldHVybiB0aHJlYWQudm9sdW1lKCkgPT09ICdtdXRlJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAnaGlkZV9tdXRlZCc6CiAgICAgICAgICAgIHJldHVybiBjaGFpbi53aGVyZShmdW5jdGlvbiAodGhyZWFkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRocmVhZC52b2x1bWUoKSAhPT0gJ211dGUnOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlICdzaG93X3Byb3Bvc2Fscyc6CiAgICAgICAgICAgIHJldHVybiBjaGFpbi53aGVyZShmdW5jdGlvbiAodGhyZWFkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRocmVhZC5oYXNEZWNpc2lvbigpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlICdoaWRlX3Byb3Bvc2Fscyc6CiAgICAgICAgICAgIHJldHVybiBjaGFpbi53aGVyZShmdW5jdGlvbiAodGhyZWFkKSB7CiAgICAgICAgICAgICAgcmV0dXJuICF0aHJlYWQuaGFzRGVjaXNpb24oKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAnb25seV90aHJlYWRzX2luX215X2dyb3Vwcyc6CiAgICAgICAgICAgIHVzZXJHcm91cElkcyA9IFNlc3Npb24udXNlcigpLmdyb3VwSWRzKCk7CiAgICAgICAgICAgIHJldHVybiBjaGFpbi5maW5kKHsKICAgICAgICAgICAgICAkb3I6IFt7CiAgICAgICAgICAgICAgICAkYW5kOiBbewogICAgICAgICAgICAgICAgICBpbnZpdGVySWQ6IHsKICAgICAgICAgICAgICAgICAgICAkbmU6IG51bGwKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByZXZva2VkQXQ6IG51bGwKICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgZ3JvdXBJZDogewogICAgICAgICAgICAgICAgICAkaW46IHVzZXJHcm91cElkcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSgpOwogICAgfSk7CiAgfQoKICByZXR1cm4gY2hhaW4uc2ltcGxlc29ydCgnbGFzdEFjdGl2aXR5QXQnLCB0cnVlKS5kYXRhKCk7Cn0KOw=="},{"version":3,"sources":["/home/gustavo/Documents/tese/loomio/vue/src/shared/services/thread_filter.coffee"],"names":[],"mappings":"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","sourcesContent":["import Session from '@/shared/services/session'\nimport Records from '@/shared/services/records'\nimport { subWeeks } from 'date-fns'\nimport { each, compact } from 'lodash'\n\nexport default (options) ->\n  chain = Records.discussions.collection.chain()\n  chain = chain.find(discardedAt: null)\n  chain = chain.find(groupId: { $in: options.group.organisationIds() })      if options.group\n  chain = chain.find(lastActivityAt: { $gt: options.from }) if options.from\n  chain = chain.find(lastActivityAt: { $lt: options.to })   if options.to\n\n  if options.ids\n    chain = chain.find(id: {$in: options.ids})\n  else\n    each compact([].concat(options.filters)), (filter) ->\n      chain = switch filter\n        when 'show_recent'    then chain.find(lastActivityAt: { $gt: subWeeks(new Date, 6) })\n        when 'show_unread'    then chain.where (thread) -> thread.isUnread()\n        when 'hide_unread'    then chain.where (thread) -> !thread.isUnread()\n        when 'show_dismissed' then chain.where (thread) -> thread.isDismissed()\n        when 'hide_dismissed' then chain.where (thread) -> !thread.isDismissed()\n        when 'show_closed'    then chain.where (thread) -> thread.closedAt?\n        when 'show_opened'    then chain.find(closedAt: null)\n        when 'show_pinned'    then chain.find(pinned: true)\n        when 'hide_pinned'    then chain.find(pinned: false)\n        when 'show_muted'     then chain.where (thread) -> thread.volume() == 'mute'\n        when 'hide_muted'     then chain.where (thread) -> thread.volume() != 'mute'\n        when 'show_proposals' then chain.where (thread) -> thread.hasDecision()\n        when 'hide_proposals' then chain.where (thread) -> !thread.hasDecision()\n        when 'only_threads_in_my_groups'\n          userGroupIds = Session.user().groupIds()\n          chain.find $or: [\n            {$and: [\n              {inviterId: {$ne: null}},\n              {revokedAt: null}\n            ]}\n            {groupId: {$in: userGroupIds}}\n          ]\n  chain.simplesort('lastActivityAt', true).data()\n"],"sourceRoot":""}]}