{"remainingRequest":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js!/home/gustavo/Documents/tese/loomio/vue/src/shared/services/page_loader.coffee","dependencies":[{"path":"/home/gustavo/Documents/tese/loomio/vue/src/shared/services/page_loader.coffee","mtime":1706724415812},{"path":"/home/gustavo/Documents/tese/loomio/vue/.babelrc","mtime":1706724415792},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/cache-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js","mtime":1706724500796},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js","mtime":1706724497848}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9tYXAgZnJvbSAibG9kYXNoL21hcCI7CmltcG9ydCBfbWVyZ2UgZnJvbSAibG9kYXNoL21lcmdlIjsKdmFyIFBhZ2VMb2FkZXI7CmltcG9ydCBSZWNvcmRzIGZyb20gJ0Avc2hhcmVkL3NlcnZpY2VzL3JlY29yZHMnOwppbXBvcnQgdXRpbHMgZnJvbSAnQC9zaGFyZWQvcmVjb3JkX3N0b3JlL3V0aWxzJzsKaW1wb3J0IFJlc3RmdWxDbGllbnQgZnJvbSAnQC9zaGFyZWQvcmVjb3JkX3N0b3JlL3Jlc3RmdWxfY2xpZW50JzsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwpleHBvcnQgZGVmYXVsdCBQYWdlTG9hZGVyID0gY2xhc3MgUGFnZUxvYWRlciB7CiAgY29uc3RydWN0b3Iob3B0cykgewogICAgdGhpcy5yZW1vdGUgPSBuZXcgUmVzdGZ1bENsaWVudCgpOwogICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICB0aGlzLnBhcmFtcyA9IG9wdHMucGFyYW1zOwogICAgdGhpcy5wYXRoID0gb3B0cy5wYXRoOwogICAgdGhpcy5wZXIgPSBvcHRzLnBhcmFtcy5wZXI7CiAgICB0aGlzLm9yZGVyID0gb3B0cy5vcmRlcjsKICAgIHRoaXMudG90YWwgPSAwOwogICAgdGhpcy5wYWdlV2luZG93ID0ge307CiAgICB0aGlzLnBhZ2VJZHMgPSB7fTsKICAgIHRoaXMuZXJyID0gbnVsbDsKICAgIHRoaXMuc3RhdHVzID0gbnVsbDsKICB9CgogIHRvdGFsUGFnZXMoKSB7CiAgICByZXR1cm4gTWF0aC5jZWlsKHBhcnNlRmxvYXQodGhpcy50b3RhbCkgLyBwYXJzZUZsb2F0KHRoaXMucGFyYW1zLnBlcikpOwogIH0KCiAgZmV0Y2gocGFnZSkgewogICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgIHJldHVybiB0aGlzLnJlbW90ZS5mZXRjaCh7CiAgICAgIHBhdGg6IHRoaXMucGF0aCwKICAgICAgcGFyYW1zOiBfbWVyZ2UoewogICAgICAgIGZyb206IChwYWdlIC0gMSkgKiB0aGlzLnBlcgogICAgICB9LCB0aGlzLnBhcmFtcykKICAgIH0pLnRoZW4oanNvbiA9PiB7CiAgICAgIHZhciBkYXRhLCBmaXJzdElkLCBsYXN0SWQ7CiAgICAgIGRhdGEgPSB1dGlscy5kZXNlcmlhbGl6ZShqc29uKTsKICAgICAgdGhpcy50b3RhbCA9IGRhdGEubWV0YS50b3RhbDsKICAgICAgZmlyc3RJZCA9IGRhdGFbZGF0YS5tZXRhLnJvb3RdWzBdW3RoaXMub3JkZXJdOwogICAgICBsYXN0SWQgPSBkYXRhW2RhdGEubWV0YS5yb290XVtkYXRhW2RhdGEubWV0YS5yb290XS5sZW5ndGggLSAxXVt0aGlzLm9yZGVyXTsKICAgICAgVnVlLnNldCh0aGlzLnBhZ2VXaW5kb3csIHBhZ2UsIFtsYXN0SWQsIGZpcnN0SWRdKTsKICAgICAgVnVlLnNldCh0aGlzLnBhZ2VJZHMsIHBhZ2UsIF9tYXAoZGF0YVtkYXRhLm1ldGEucm9vdF0sICdpZCcpKTsgLy8gY29uc29sZS5sb2cgJ3BhZ2UnLCBwYWdlLCAnZGlzY3Vzc2lvbnMubGVuZ3RoJywgZGF0YS5kaXNjdXNzaW9ucy5sZW5ndGgsICdmaXJzdCcsIGZpcnN0SWQsICdsYXN0JywgbGFzdElkLCAnZ3JvdXBJZHMhJywgb3JkZXJCeSB1bmlxKG1hcChkYXRhWydkaXNjdXNzaW9ucyddLCAnZ3JvdXBJZCcpKQoKICAgICAgcmV0dXJuIFJlY29yZHMuaW1wb3J0UkVBRFkoZGF0YSk7CiAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICB0aGlzLmVyciA9IGVycjsKICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzID0gZXJyLnN0YXR1czsKICAgIH0pLmZpbmFsbHkoKCkgPT4gewogICAgICByZXR1cm4gdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICB9KTsKICB9Cgp9Ow=="},{"version":3,"sources":["/home/gustavo/Documents/tese/loomio/vue/src/shared/services/page_loader.coffee"],"names":[],"mappings":";;AAAA,IAAA,UAAA;AAAA,OAAA,OAAA,MAAA,2BAAA;AACA,OAAA,KAAA,MAAA,6BAAA;AACA,OAAA,aAAA,MAAA,sCAAA;AACA,OAAA,GAAA,MAAA,KAAA;AAGA,eAAqB,UAAA,GAAN,MAAA,UAAA,CAAA;AACb,EAAA,WAAa,CAAA,IAAA,EAAA;AACX,SAAA,MAAA,GAAU,IAAA,aAAA,EAAV;AACA,SAAA,OAAA,GAAW,KAAX;AACA,SAAA,MAAA,GAAU,IAAI,CAAC,MAAf;AACA,SAAA,IAAA,GAAQ,IAAI,CAAC,IAAb;AACA,SAAA,GAAA,GAAO,IAAI,CAAC,MAAL,CAAY,GAAnB;AACA,SAAA,KAAA,GAAS,IAAI,CAAC,KAAd;AACA,SAAA,KAAA,GAAS,CAAT;AACA,SAAA,UAAA,GAAc,EAAd;AACA,SAAA,OAAA,GAAW,EAAX;AACA,SAAA,GAAA,GAAO,IAAP;AACA,SAAA,MAAA,GAAU,IAAV;AAXW;;AAab,EAAA,UAAY,GAAA;WACV,IAAI,CAAJ,IAAA,CAAU,UAAA,CAAW,KAAX,KAAA,CAAA,GAAqB,UAAA,CAAW,KAAC,MAAD,CAA1C,GAA+B,CAA/B,C;AADU;;AAGZ,EAAA,KAAO,CAAA,IAAA,EAAA;AACL,SAAA,OAAA,GAAW,IAAX;WACA,KAAC,MAAD,CAAA,KAAA,CACE;AAAA,MAAA,IAAA,EAAM,KAAN,IAAA;AACA,MAAA,MAAA,EAAQ,OAAM;AAAC,QAAA,IAAA,EAAO,CAAC,IAAA,GAAD,CAAA,IAAa,KAAC;AAAtB,OAAN,EAAmC,KAAnC,MAAA;AADR,KADF,EAAA,IAAA,CAGM,IAAA,IAAA;AACV,UAAA,IAAA,EAAA,OAAA,EAAA,MAAA;AAAM,MAAA,IAAA,GAAO,KAAK,CAAL,WAAA,CAAA,IAAA,CAAP;AACA,WAAA,KAAA,GAAS,IAAI,CAAC,IAAL,CAAU,KAAnB;AACA,MAAA,OAAA,GAAU,IAAI,CAAC,IAAI,CAAC,IAAL,CAAD,IAAA,CAAJ,CAAoB,CAApB,EAAwB,KAAD,KAAvB,CAAV;AACA,MAAA,MAAA,GAAS,IAAI,CAAC,IAAI,CAAC,IAAL,CAAD,IAAA,CAAJ,CAAsB,IAAI,CAAC,IAAI,CAAC,IAAL,CAAD,IAAA,CAAJ,CAAA,MAAA,GAAF,CAApB,EAAwD,KAAD,KAAvD,CAAT;AACA,MAAA,GAAG,CAAH,GAAA,CAAQ,KAAR,UAAA,EAAA,IAAA,EAA2B,CAAA,MAAA,EAA3B,OAA2B,CAA3B;AACA,MAAA,GAAG,CAAH,GAAA,CAAQ,KAAR,OAAA,EAAA,IAAA,EAAwB,KAAI,IAAI,CAAC,IAAI,CAAC,IAAL,CAAT,IAAQ,CAAR,EAL9B,IAK8B,CAAxB,EANI,C;;aAQJ,OAAO,CAAP,WAAA,CAAA,IAAA,C;AAXF,KAAA,EAAA,KAAA,CAYO,GAAA,IAAA;AACL,WAAA,GAAA,GAAO,GAAP;aACA,KAAA,MAAA,GAAU,GAAG,CAAC,M;AAdhB,KAAA,EAAA,OAAA,CAeS,MAAA;aACP,KAAA,OAAA,GAAW,K;AAhBb,KAAA,C;AAFK;;AAjBM,CAAf","sourcesContent":["import Records from '@/shared/services/records'\nimport utils         from '@/shared/record_store/utils'\nimport RestfulClient from '@/shared/record_store/restful_client'\nimport Vue from 'vue'\nimport {merge, camelCase, defaults, max, orderBy, uniq, map } from 'lodash'\n\nexport default class PageLoader\n  constructor: (opts) ->\n    @remote = new RestfulClient\n    @loading = false\n    @params = opts.params\n    @path = opts.path\n    @per = opts.params.per\n    @order = opts.order\n    @total = 0\n    @pageWindow = {}\n    @pageIds = {}\n    @err = null\n    @status = null\n\n  totalPages: ->\n    Math.ceil(parseFloat(@total) / parseFloat(@params.per))\n\n  fetch: (page) ->\n    @loading = true\n    @remote.fetch\n      path: @path\n      params: merge({from: ((page - 1) * @per)}, @params)\n    .then (json) =>\n      data = utils.deserialize(json)\n      @total = data.meta.total\n      firstId = data[data.meta.root][0][@order]\n      lastId = data[data.meta.root][(data[data.meta.root].length - 1)][@order]\n      Vue.set(@pageWindow, page, [lastId,firstId])\n      Vue.set(@pageIds, page, map(data[data.meta.root], 'id'))\n      # console.log 'page', page, 'discussions.length', data.discussions.length, 'first', firstId, 'last', lastId, 'groupIds!', orderBy uniq(map(data['discussions'], 'groupId'))\n      Records.importREADY(data)\n    .catch (err) =>\n      @err = err\n      @status = err.status\n    .finally =>\n      @loading = false\n"],"sourceRoot":""}]}