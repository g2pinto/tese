{"remainingRequest":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js!/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js!/home/gustavo/Documents/tese/loomio/vue/src/shared/models/discussion_model.coffee","dependencies":[{"path":"/home/gustavo/Documents/tese/loomio/vue/src/shared/models/discussion_model.coffee","mtime":1706724415808},{"path":"/home/gustavo/Documents/tese/loomio/vue/.babelrc","mtime":1706724415792},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/cache-loader/dist/cjs.js","mtime":1706724497848},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/babel-loader/lib/index.js","mtime":1706724500796},{"path":"/home/gustavo/Documents/tese/loomio/vue/node_modules/vue-cli-plugin-coffee/node_modules/coffee-loader/dist/cjs.js","mtime":1706724497848}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90aHJvdHRsZSBmcm9tICJsb2Rhc2gvdGhyb3R0bGUiOwppbXBvcnQgX2lzQXJyYXkgZnJvbSAibG9kYXNoL2lzQXJyYXkiOwppbXBvcnQgX3NvcnRCeSBmcm9tICJsb2Rhc2gvc29ydEJ5IjsKaW1wb3J0IF9sYXN0IGZyb20gImxvZGFzaC9sYXN0IjsKaW1wb3J0IF9oZWFkIGZyb20gImxvZGFzaC9oZWFkIjsKaW1wb3J0IF9zb21lIGZyb20gImxvZGFzaC9zb21lIjsKaW1wb3J0IF9maWx0ZXIgZnJvbSAibG9kYXNoL2ZpbHRlciI7CmltcG9ydCBfaXNFbXB0eSBmcm9tICJsb2Rhc2gvaXNFbXB0eSI7CmltcG9ydCBfaXNFcXVhbCBmcm9tICJsb2Rhc2gvaXNFcXVhbCI7CmltcG9ydCBfZmxhdHRlbiBmcm9tICJsb2Rhc2gvZmxhdHRlbiI7CmltcG9ydCBfY29tcGFjdCBmcm9tICJsb2Rhc2gvY29tcGFjdCI7CmltcG9ydCBfbWFwIGZyb20gImxvZGFzaC9tYXAiOwoKdmFyIERpc2N1c3Npb25Nb2RlbCwKICAgIGJvdW5kTWV0aG9kQ2hlY2sgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBFcnJvcignQm91bmQgaW5zdGFuY2UgbWV0aG9kIGFjY2Vzc2VkIGJlZm9yZSBiaW5kaW5nJyk7CiAgfQp9OwoKaW1wb3J0IEJhc2VNb2RlbCBmcm9tICdAL3NoYXJlZC9yZWNvcmRfc3RvcmUvYmFzZV9tb2RlbCc7CmltcG9ydCBBcHBDb25maWcgZnJvbSAnQC9zaGFyZWQvc2VydmljZXMvYXBwX2NvbmZpZyc7CmltcG9ydCBTZXNzaW9uIGZyb20gJ0Avc2hhcmVkL3NlcnZpY2VzL3Nlc3Npb24nOwppbXBvcnQgUmFuZ2VTZXQgZnJvbSAnQC9zaGFyZWQvc2VydmljZXMvcmFuZ2Vfc2V0JzsKaW1wb3J0IEhhc0RvY3VtZW50cyBmcm9tICdAL3NoYXJlZC9taXhpbnMvaGFzX2RvY3VtZW50cyc7CmltcG9ydCBIYXNUcmFuc2xhdGlvbnMgZnJvbSAnQC9zaGFyZWQvbWl4aW5zL2hhc190cmFuc2xhdGlvbnMnOwppbXBvcnQgeyBpc0FmdGVyIH0gZnJvbSAnZGF0ZS1mbnMnOwppbXBvcnQgZGF0ZUlzRXF1YWwgZnJvbSAnZGF0ZS1mbnMvaXNFcXVhbCc7CmltcG9ydCBJMThuIGZyb20gJ0AvaTE4bic7CmV4cG9ydCBkZWZhdWx0IERpc2N1c3Npb25Nb2RlbCA9IGZ1bmN0aW9uICgpIHsKICBjbGFzcyBEaXNjdXNzaW9uTW9kZWwgZXh0ZW5kcyBCYXNlTW9kZWwgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7CiAgICAgIHRoaXMucHJpdmF0ZURlZmF1bHRWYWx1ZSA9IHRoaXMucHJpdmF0ZURlZmF1bHRWYWx1ZS5iaW5kKHRoaXMpOwogICAgICB0aGlzLnNhdmVWb2x1bWUgPSB0aGlzLnNhdmVWb2x1bWUuYmluZCh0aGlzKTsKICAgICAgdGhpcy5tb3ZlID0gdGhpcy5tb3ZlLmJpbmQodGhpcyk7CiAgICAgIHRoaXMuc2F2ZVBpbiA9IHRoaXMuc2F2ZVBpbi5iaW5kKHRoaXMpOwogICAgICB0aGlzLnNhdmVVbnBpbiA9IHRoaXMuc2F2ZVVucGluLmJpbmQodGhpcyk7CiAgICAgIHRoaXMuY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7CiAgICAgIHRoaXMucmVvcGVuID0gdGhpcy5yZW9wZW4uYmluZCh0aGlzKTsKICAgICAgdGhpcy5mb3JrID0gdGhpcy5mb3JrLmJpbmQodGhpcyk7CiAgICAgIHRoaXMubW92ZUNvbW1lbnRzID0gdGhpcy5tb3ZlQ29tbWVudHMuYmluZCh0aGlzKTsKICAgIH0KCiAgICBhZnRlckNvbnN0cnVjdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaXNOZXcoKSkgewogICAgICAgIHRoaXMucHJpdmF0ZSA9IHRoaXMucHJpdmF0ZURlZmF1bHRWYWx1ZSgpOwogICAgICB9CgogICAgICBIYXNEb2N1bWVudHMuYXBwbHkodGhpcywgewogICAgICAgIHNob3dUaXRsZTogdHJ1ZQogICAgICB9KTsKICAgICAgcmV0dXJuIEhhc1RyYW5zbGF0aW9ucy5hcHBseSh0aGlzKTsKICAgIH0KCiAgICBkZWZhdWx0VmFsdWVzKCkgewogICAgICByZXR1cm4gewogICAgICAgIGlkOiBudWxsLAogICAgICAgIGtleTogbnVsbCwKICAgICAgICBwcml2YXRlOiB0cnVlLAogICAgICAgIGxhc3RJdGVtQXQ6IG51bGwsCiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBkZXNjcmlwdGlvbkZvcm1hdDogJ2h0bWwnLAogICAgICAgIGZvcmtlZEV2ZW50SWRzOiBbXSwKICAgICAgICByYW5nZXM6IFtdLAogICAgICAgIHJlYWRSYW5nZXM6IFtdLAogICAgICAgIG5ld2VzdEZpcnN0OiBmYWxzZSwKICAgICAgICBmaWxlczogW10sCiAgICAgICAgaW1hZ2VGaWxlczogW10sCiAgICAgICAgYXR0YWNobWVudHM6IFtdLAogICAgICAgIGxpbmtQcmV2aWV3czogW10sCiAgICAgICAgdGFnczogW10sCiAgICAgICAgcmVjaXBpZW50TWVzc2FnZTogbnVsbCwKICAgICAgICByZWNpcGllbnRBdWRpZW5jZTogbnVsbCwKICAgICAgICByZWNpcGllbnRVc2VySWRzOiBbXSwKICAgICAgICByZWNpcGllbnRDaGF0Ym90SWRzOiBbXSwKICAgICAgICByZWNpcGllbnRFbWFpbHM6IFtdLAogICAgICAgIG5vdGlmeVJlY2lwaWVudHM6IHRydWUsCiAgICAgICAgZ3JvdXBJZDogbnVsbCwKICAgICAgICB1c2Vyc05vdGlmaWVkQ291bnQ6IG51bGwsCiAgICAgICAgZGlzY3Vzc2lvblJlYWRlclVzZXJJZDogbnVsbCwKICAgICAgICBwaW5uZWRBdDogbnVsbCwKICAgICAgICB0ZW1wbGF0ZTogZmFsc2UKICAgICAgfTsKICAgIH0KCiAgICBjbG9uZVRlbXBsYXRlKCkgewogICAgICB2YXIgY2xvbmU7CiAgICAgIGNsb25lID0gdGhpcy5jbG9uZSgpOwogICAgICBjbG9uZS5pZCA9IG51bGw7CiAgICAgIGNsb25lLmtleSA9IG51bGw7CiAgICAgIGNsb25lLnRpdGxlID0gSTE4bi50KCd0ZW1wbGF0ZXMuY29weV9vZl90aXRsZScsIHsKICAgICAgICB0aXRsZTogY2xvbmUudGl0bGUKICAgICAgfSk7CiAgICAgIGNsb25lLnNvdXJjZVRlbXBsYXRlSWQgPSB0aGlzLmlkOwogICAgICBjbG9uZS5hdXRob3JJZCA9IFNlc3Npb24udXNlcigpLmlkOwogICAgICBjbG9uZS5waW5uZWRBdCA9IG51bGw7CiAgICAgIGNsb25lLmZvcmtlZEV2ZW50SWRzID0gW107CiAgICAgIGNsb25lLmdyb3VwSWQgPSBudWxsOwogICAgICBjbG9uZS5jbG9zZWRBdCA9IG51bGw7CiAgICAgIGNsb25lLmNyZWF0ZWRBdCA9IG51bGw7CiAgICAgIGNsb25lLnVwZGF0ZWRBdCA9IG51bGw7CiAgICAgIGNsb25lLnRlbXBsYXRlID0gZmFsc2U7CiAgICAgIHJldHVybiBjbG9uZTsKICAgIH0KCiAgICBhdWRpZW5jZVZhbHVlcygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiB0aGlzLmdyb3VwKCkubmFtZQogICAgICB9OwogICAgfQoKICAgIHByaXZhdGVEZWZhdWx0VmFsdWUoKSB7CiAgICAgIGJvdW5kTWV0aG9kQ2hlY2sodGhpcywgRGlzY3Vzc2lvbk1vZGVsKTsKICAgICAgcmV0dXJuIHRoaXMuZ3JvdXAoKS5kaXNjdXNzaW9uUHJpdmFjeU9wdGlvbnMgIT09ICdwdWJsaWNfb25seSc7CiAgICB9CgogICAgcmVsYXRpb25zaGlwcygpIHsKICAgICAgdGhpcy5oYXNNYW55KCdwb2xscycsIHsKICAgICAgICBzb3J0Qnk6ICdjcmVhdGVkQXQnLAogICAgICAgIHNvcnREZXNjOiB0cnVlLAogICAgICAgIGZpbmQ6IHsKICAgICAgICAgIGRpc2NhcmRlZEF0OiBudWxsCiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5iZWxvbmdzVG8oJ2dyb3VwJyk7CiAgICAgIHRoaXMuYmVsb25nc1RvKCdhdXRob3InLCB7CiAgICAgICAgZnJvbTogJ3VzZXJzJwogICAgICB9KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzTWFueSgnZGlzY3Vzc2lvblJlYWRlcnMnKTsKICAgIH0gLy8gQGJlbG9uZ3NUbyAnY3JlYXRlZEV2ZW50JywgZnJvbTogJ2V2ZW50cycKICAgIC8vIEBiZWxvbmdzVG8gJ2ZvcmtlZEV2ZW50JywgZnJvbTogJ2V2ZW50cycKCgogICAgZGlzY3Vzc2lvbigpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgc291cmNlVGVtcGxhdGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnJlY29yZFN0b3JlLmRpc2N1c3Npb25zLmZpbmQodGhpcy5zb3VyY2VUZW1wbGF0ZUlkKTsKICAgIH0KCiAgICB0YWdzKCkgewogICAgICByZXR1cm4gdGhpcy5yZWNvcmRTdG9yZS50YWdzLmNvbGxlY3Rpb24uY2hhaW4oKS5maW5kKHsKICAgICAgICBpZDogewogICAgICAgICAgJGluOiB0aGlzLnRhZ0lkcwogICAgICAgIH0KICAgICAgfSkuc2ltcGxlc29ydCgncHJpb3JpdHknKS5kYXRhKCk7CiAgICB9CgogICAgbWVtYmVycygpIHsKICAgICAgcmV0dXJuIHRoaXMucmVjb3JkU3RvcmUudXNlcnMuZmluZCh0aGlzLmdyb3VwKCkubWVtYmVySWRzKCkuY29uY2F0KF9tYXAodGhpcy5kaXNjdXNzaW9uUmVhZGVycygpLCAndXNlcklkJykpKTsKICAgIH0KCiAgICBtZW1iZXJzSW5jbHVkZSh1c2VyKSB7CiAgICAgIHJldHVybiB0aGlzLmludml0ZXJJZCAmJiAhdGhpcy5yZXZva2VkQXQgJiYgU2Vzc2lvbi51c2VyKCkuaWQgPT09IHVzZXIuaWQgfHwgdGhpcy5ncm91cCgpLm1lbWJlcnNJbmNsdWRlKHVzZXIpOwogICAgfQoKICAgIGFkbWluc0luY2x1ZGUodXNlcikgewogICAgICByZXR1cm4gdGhpcy5hdXRob3JJZCA9PT0gdXNlci5pZCB8fCB0aGlzLmludml0ZXJJZCAmJiB0aGlzLmFkbWluICYmICF0aGlzLnJldm9rZWRBdCAmJiBBcHBDb25maWcuY3VycmVudFVzZXJJZCA9PT0gdXNlci5pZCB8fCB0aGlzLmdyb3VwKCkuYWRtaW5zSW5jbHVkZSh1c2VyKTsKICAgIH0gLy8ga25vd24gY3VycmVudCBwYXJ0aWNpcGFudHMgZm9yIHF1aWNrIG1lbnRpb25pbmcKCgogICAgcGFydGljaXBhbnRJZHMoKSB7CiAgICAgIHJldHVybiBfY29tcGFjdChfZmxhdHRlbihfbWFwKHRoaXMucmVjb3JkU3RvcmUuY29tbWVudHMuZmluZCh7CiAgICAgICAgZGlzY3Vzc2lvbklkOiB0aGlzLmlkCiAgICAgIH0pLCAnYXV0aG9ySWQnKSwgX21hcCh0aGlzLnJlY29yZFN0b3JlLnBvbGxzLmZpbmQoewogICAgICAgIGRpc2N1c3Npb25JZDogdGhpcy5pZAogICAgICB9KSwgZnVuY3Rpb24gKHApIHsKICAgICAgICByZXR1cm4gcC5wYXJ0aWNpcGFudElkcygpOwogICAgICB9KSwgW3RoaXMuYXV0aG9ySWRdKSk7CiAgICB9CgogICAgYmVzdE5hbWVkSWQoKSB7CiAgICAgIHJldHVybiAodGhpcy5pZCAmJiB0aGlzIHx8IHRoaXMuZ3JvdXBJZCAmJiB0aGlzLmdyb3VwKCkgfHwgewogICAgICAgIG5hbWVkSWQ6IGZ1bmN0aW9uICgpIHt9CiAgICAgIH0pLm5hbWVkSWQoKTsKICAgIH0KCiAgICBjcmVhdGVkRXZlbnQoKSB7CiAgICAgIHZhciByZXM7CiAgICAgIHJlcyA9IHRoaXMucmVjb3JkU3RvcmUuZXZlbnRzLmZpbmQoewogICAgICAgIGtpbmQ6ICduZXdfZGlzY3Vzc2lvbicsCiAgICAgICAgZXZlbnRhYmxlSWQ6IHRoaXMuaWQKICAgICAgfSk7CgogICAgICBpZiAoIV9pc0VtcHR5KHJlcykpIHsKICAgICAgICByZXR1cm4gcmVzWzBdOwogICAgICB9CiAgICB9CgogICAgZm9ya2VkRXZlbnQoKSB7CiAgICAgIHZhciByZXM7CiAgICAgIHJlcyA9IHRoaXMucmVjb3JkU3RvcmUuZXZlbnRzLmZpbmQoewogICAgICAgIGtpbmQ6ICdkaXNjdXNzaW9uX2ZvcmtlZCcsCiAgICAgICAgZXZlbnRhYmxlSWQ6IHRoaXMuaWQKICAgICAgfSk7CgogICAgICBpZiAoIV9pc0VtcHR5KHJlcykpIHsKICAgICAgICByZXR1cm4gcmVzWzBdOwogICAgICB9CiAgICB9CgogICAgcmVhY3Rpb25zKCkgewogICAgICByZXR1cm4gdGhpcy5yZWNvcmRTdG9yZS5yZWFjdGlvbnMuZmluZCh7CiAgICAgICAgcmVhY3RhYmxlSWQ6IHRoaXMuaWQsCiAgICAgICAgcmVhY3RhYmxlVHlwZTogIkRpc2N1c3Npb24iCiAgICAgIH0pOwogICAgfQoKICAgIHRyYW5zbGF0aW9uT3B0aW9ucygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB0aXRsZTogdGhpcy50aXRsZSwKICAgICAgICBncm91cE5hbWU6IHRoaXMuZ3JvdXBOYW1lKCkKICAgICAgfTsKICAgIH0KCiAgICBhdXRob3JOYW1lKCkgewogICAgICByZXR1cm4gdGhpcy5hdXRob3IoKS5uYW1lV2l0aFRpdGxlKHRoaXMuZ3JvdXAoKSk7CiAgICB9CgogICAgaXNCbGFuaygpIHsKICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb24gPT09ICcnIHx8IHRoaXMuZGVzY3JpcHRpb24gPT09IG51bGwgfHwgdGhpcy5kZXNjcmlwdGlvbiA9PT0gJzxwPjwvcD4nOwogICAgfQoKICAgIGdyb3VwTmFtZSgpIHsKICAgICAgcmV0dXJuICh0aGlzLmdyb3VwKCkgfHwge30pLm5hbWU7CiAgICB9CgogICAgYWN0aXZlUG9sbHMoKSB7CiAgICAgIHJldHVybiBfZmlsdGVyKHRoaXMucG9sbHMoKSwgZnVuY3Rpb24gKHBvbGwpIHsKICAgICAgICByZXR1cm4gcG9sbC5pc1ZvdGFibGUoKTsKICAgICAgfSk7CiAgICB9CgogICAgaGFzQWN0aXZlUG9sbCgpIHsKICAgICAgcmV0dXJuIF9zb21lKHRoaXMuYWN0aXZlUG9sbHMoKSk7CiAgICB9CgogICAgaGFzRGVjaXNpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmhhc0FjdGl2ZVBvbGwoKTsKICAgIH0KCiAgICBjbG9zZWRQb2xscygpIHsKICAgICAgcmV0dXJuIF9maWx0ZXIodGhpcy5wb2xscygpLCBmdW5jdGlvbiAocG9sbCkgewogICAgICAgIHJldHVybiAhcG9sbC5pc1ZvdGFibGUoKTsKICAgICAgfSk7CiAgICB9CgogICAgYWN0aXZlUG9sbCgpIHsKICAgICAgcmV0dXJuIF9oZWFkKHRoaXMuYWN0aXZlUG9sbHMoKSk7CiAgICB9CgogICAgaXNVbnJlYWQoKSB7CiAgICAgIHJldHVybiAhdGhpcy5pc0Rpc21pc3NlZCgpICYmICh0aGlzLmxhc3RSZWFkQXQgPT0gbnVsbCB8fCB0aGlzLnVucmVhZEl0ZW1zQ291bnQoKSA+IDApOwogICAgfQoKICAgIGlzRGlzbWlzc2VkKCkgewogICAgICByZXR1cm4gdGhpcy5kaXNjdXNzaW9uUmVhZGVySWQgIT0gbnVsbCAmJiB0aGlzLmRpc21pc3NlZEF0ICE9IG51bGwgJiYgKGRhdGVJc0VxdWFsKHRoaXMuZGlzbWlzc2VkQXQsIHRoaXMubGFzdEFjdGl2aXR5QXQpIHx8IGlzQWZ0ZXIodGhpcy5kaXNtaXNzZWRBdCwgdGhpcy5sYXN0QWN0aXZpdHlBdCkpOwogICAgfQoKICAgIGhhc1VucmVhZEFjdGl2aXR5KCkgewogICAgICByZXR1cm4gdGhpcy5pc1VucmVhZCgpICYmIHRoaXMudW5yZWFkSXRlbXNDb3VudCgpID4gMDsKICAgIH0KCiAgICBtZW1iZXJzaGlwKCkgewogICAgICByZXR1cm4gdGhpcy5yZWNvcmRTdG9yZS5tZW1iZXJzaGlwcy5maW5kKHsKICAgICAgICB1c2VySWQ6IEFwcENvbmZpZy5jdXJyZW50VXNlcklkLAogICAgICAgIGdyb3VwSWQ6IHRoaXMuZ3JvdXBJZAogICAgICB9KVswXTsKICAgIH0KCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiB0aGlzLmRpc2N1c3Npb25SZWFkZXJWb2x1bWU7CiAgICB9CgogICAgc2F2ZVZvbHVtZSh2b2x1bWUpIHsKICAgICAgbGV0IGFwcGx5VG9BbGwgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICBib3VuZE1ldGhvZENoZWNrKHRoaXMsIERpc2N1c3Npb25Nb2RlbCk7CiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7CgogICAgICBpZiAoYXBwbHlUb0FsbCkgewogICAgICAgIHJldHVybiB0aGlzLm1lbWJlcnNoaXAoKS5zYXZlVm9sdW1lKHZvbHVtZSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzaW5nID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHZvbHVtZSAhPSBudWxsKSB7CiAgICAgICAgICB0aGlzLmRpc2N1c3Npb25SZWFkZXJWb2x1bWUgPSB2b2x1bWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGUucGF0Y2hNZW1iZXIodGhpcy5rZXlPcklkKCksICdzZXRfdm9sdW1lJywgewogICAgICAgICAgdm9sdW1lOiB0aGlzLmRpc2N1c3Npb25SZWFkZXJWb2x1bWUKICAgICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGlzTXV0ZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZvbHVtZSgpID09PSAnbXV0ZSc7CiAgICB9CgogICAgbWFya0FzU2VlbigpIHsKICAgICAgaWYgKHRoaXMubGFzdFJlYWRBdCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5yZW1vdGUucGF0Y2hNZW1iZXIodGhpcy5rZXlPcklkKCksICdtYXJrX2FzX3NlZW4nKTsKICAgICAgcmV0dXJuIHRoaXMudXBkYXRlKHsKICAgICAgICBsYXN0UmVhZEF0OiBuZXcgRGF0ZSgpCiAgICAgIH0pOwogICAgfQoKICAgIG1hcmtBc1JlYWQoaWQpIHsKICAgICAgaWYgKHRoaXMuaGFzUmVhZChpZCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMucmVhZFJhbmdlcy5wdXNoKFtpZCwgaWRdKTsKICAgICAgdGhpcy5yZWFkUmFuZ2VzID0gUmFuZ2VTZXQucmVkdWNlKHRoaXMucmVhZFJhbmdlcyk7CiAgICAgIHJldHVybiB0aGlzLnVwZGF0ZVJlYWRSYW5nZXMoKTsKICAgIH0KCiAgICB1cGRhdGUoYXR0cmlidXRlcykgewogICAgICBpZiAoX2lzQXJyYXkodGhpcy5yZWFkUmFuZ2VzKSAmJiBfaXNBcnJheShhdHRyaWJ1dGVzLnJlYWRSYW5nZXMpICYmICFfaXNFcXVhbChhdHRyaWJ1dGVzLnJlYWRSYW5nZXMsIHRoaXMucmVhZFJhbmdlcykpIHsKICAgICAgICBhdHRyaWJ1dGVzLnJlYWRSYW5nZXMgPSBSYW5nZVNldC5yZWR1Y2UodGhpcy5yZWFkUmFuZ2VzLmNvbmNhdChhdHRyaWJ1dGVzLnJlYWRSYW5nZXMpKTsKICAgICAgfQoKICAgICAgdGhpcy5iYXNlVXBkYXRlKGF0dHJpYnV0ZXMpOwogICAgICByZXR1cm4gdGhpcy5yZWFkUmFuZ2VzID0gUmFuZ2VTZXQuaW50ZXJzZWN0UmFuZ2VzKHRoaXMucmVhZFJhbmdlcywgdGhpcy5yYW5nZXMpOwogICAgfQoKICAgIGhhc1JlYWQoaWQpIHsKICAgICAgcmV0dXJuIFJhbmdlU2V0LmluY2x1ZGVzVmFsdWUodGhpcy5yZWFkUmFuZ2VzLCBpZCk7CiAgICB9CgogICAgdW5yZWFkSXRlbXNDb3VudCgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXRlbXNDb3VudCAtIHRoaXMucmVhZEl0ZW1zQ291bnQoKTsKICAgIH0KCiAgICByZWFkSXRlbXNDb3VudCgpIHsKICAgICAgcmV0dXJuIFJhbmdlU2V0Lmxlbmd0aCh0aGlzLnJlYWRSYW5nZXMpOwogICAgfQoKICAgIGZpcnN0U2VxdWVuY2VJZCgpIHsKICAgICAgcmV0dXJuIChfaGVhZCh0aGlzLnJhbmdlcykgfHwgW10pWzBdOwogICAgfQoKICAgIGxhc3RTZXF1ZW5jZUlkKCkgewogICAgICByZXR1cm4gKF9sYXN0KHRoaXMucmFuZ2VzKSB8fCBbXSlbMV07CiAgICB9CgogICAgbGFzdFJlYWRTZXF1ZW5jZUlkKCkgewogICAgICByZXR1cm4gKF9sYXN0KHRoaXMucmVhZFJhbmdlcykgfHwgW10pWzFdOwogICAgfQoKICAgIGZpcnN0VW5yZWFkU2VxdWVuY2VJZCgpIHsKICAgICAgcmV0dXJuICh0aGlzLnVucmVhZFJhbmdlcygpWzBdIHx8IFtdKVswXTsKICAgIH0KCiAgICByZWFkU2VxdWVuY2VJZHMoKSB7CiAgICAgIHJldHVybiBSYW5nZVNldC5yYW5nZXNUb0FycmF5KHRoaXMucmVhZFJhbmdlcyk7CiAgICB9CgogICAgdW5yZWFkUmFuZ2VzKCkgewogICAgICByZXR1cm4gUmFuZ2VTZXQuc3VidHJhY3RSYW5nZXModGhpcy5yYW5nZXMsIHRoaXMucmVhZFJhbmdlcyk7CiAgICB9CgogICAgdW5yZWFkU2VxdWVuY2VJZHMoKSB7CiAgICAgIHJldHVybiBSYW5nZVNldC5yYW5nZXNUb0FycmF5KHRoaXMudW5yZWFkUmFuZ2VzKCkpOwogICAgfQoKICAgIGRpc21pc3MoKSB7CiAgICAgIHRoaXMudXBkYXRlKHsKICAgICAgICBkaXNtaXNzZWRBdDogbmV3IERhdGUoKQogICAgICB9KTsKICAgICAgdGhpcy5wcm9jZXNzaW5nID0gdHJ1ZTsKICAgICAgcmV0dXJuIHRoaXMucmVtb3RlLnBhdGNoTWVtYmVyKHRoaXMua2V5T3JJZCgpLCAnZGlzbWlzcycpLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgcmVjYWxsKCkgewogICAgICB0aGlzLnVwZGF0ZSh7CiAgICAgICAgZGlzbWlzc2VkQXQ6IG51bGwKICAgICAgfSk7CiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLnJlbW90ZS5wYXRjaE1lbWJlcih0aGlzLmtleU9ySWQoKSwgJ3JlY2FsbCcpLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgbW92ZSgpIHsKICAgICAgYm91bmRNZXRob2RDaGVjayh0aGlzLCBEaXNjdXNzaW9uTW9kZWwpOwogICAgICB0aGlzLnByb2Nlc3NpbmcgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5yZW1vdGUucGF0Y2hNZW1iZXIodGhpcy5rZXlPcklkKCksICdtb3ZlJywgewogICAgICAgIGdyb3VwX2lkOiB0aGlzLmdyb3VwSWQKICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc2luZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0KCiAgICBzYXZlUGluKCkgewogICAgICBib3VuZE1ldGhvZENoZWNrKHRoaXMsIERpc2N1c3Npb25Nb2RlbCk7CiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLnJlbW90ZS5wYXRjaE1lbWJlcih0aGlzLmtleU9ySWQoKSwgJ3BpbicpLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgc2F2ZVVucGluKCkgewogICAgICBib3VuZE1ldGhvZENoZWNrKHRoaXMsIERpc2N1c3Npb25Nb2RlbCk7CiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLnJlbW90ZS5wYXRjaE1lbWJlcih0aGlzLmtleU9ySWQoKSwgJ3VucGluJykuZmluYWxseSgoKSA9PiB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc2luZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0KCiAgICBjbG9zZSgpIHsKICAgICAgYm91bmRNZXRob2RDaGVjayh0aGlzLCBEaXNjdXNzaW9uTW9kZWwpOwogICAgICB0aGlzLnByb2Nlc3NpbmcgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5yZW1vdGUucGF0Y2hNZW1iZXIodGhpcy5rZXlPcklkKCksICdjbG9zZScpLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgcmVvcGVuKCkgewogICAgICBib3VuZE1ldGhvZENoZWNrKHRoaXMsIERpc2N1c3Npb25Nb2RlbCk7CiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLnJlbW90ZS5wYXRjaE1lbWJlcih0aGlzLmtleU9ySWQoKSwgJ3Jlb3BlbicpLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgZm9yaygpIHsKICAgICAgYm91bmRNZXRob2RDaGVjayh0aGlzLCBEaXNjdXNzaW9uTW9kZWwpOwogICAgICB0aGlzLnByb2Nlc3NpbmcgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5yZW1vdGUucG9zdCgnZm9yaycsIHRoaXMuc2VyaWFsaXplKCkpLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgbW92ZUNvbW1lbnRzKCkgewogICAgICBib3VuZE1ldGhvZENoZWNrKHRoaXMsIERpc2N1c3Npb25Nb2RlbCk7CiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLnJlbW90ZS5wYXRjaE1lbWJlcih0aGlzLmtleU9ySWQoKSwgJ21vdmVfY29tbWVudHMnLCB7CiAgICAgICAgZm9ya2VkX2V2ZW50X2lkczogdGhpcy5mb3JrZWRFdmVudElkcwogICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfQoKICAgIGZldGNoVXNlcnNOb3RpZmllZENvdW50KCkgewogICAgICByZXR1cm4gdGhpcy5yZWNvcmRTdG9yZS5mZXRjaCh7CiAgICAgICAgcGF0aDogJ2Fubm91bmNlbWVudHMvdXNlcnNfbm90aWZpZWRfY291bnQnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgZGlzY3Vzc2lvbl9pZDogdGhpcy5pZAogICAgICAgIH0KICAgICAgfSkudGhlbihkYXRhID0+IHsKICAgICAgICByZXR1cm4gdGhpcy51c2Vyc05vdGlmaWVkQ291bnQgPSBkYXRhLmNvdW50OwogICAgICB9KTsKICAgIH0KCiAgICBmb3JrZWRFdmVudHMoKSB7CiAgICAgIHJldHVybiBfc29ydEJ5KHRoaXMucmVjb3JkU3RvcmUuZXZlbnRzLmZpbmQodGhpcy5mb3JrZWRFdmVudElkcyksICdzZXF1ZW5jZUlkJyk7CiAgICB9CgogICAgZm9ya1RhcmdldCgpIHsKICAgICAgaWYgKF9zb21lKHRoaXMuZm9ya2VkRXZlbnRzKCkpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9ya2VkRXZlbnRzKClbMF0ubW9kZWwoKTsKICAgICAgfQogICAgfQoKICB9CgogIDsKICBEaXNjdXNzaW9uTW9kZWwuc2luZ3VsYXIgPSAnZGlzY3Vzc2lvbic7CiAgRGlzY3Vzc2lvbk1vZGVsLnBsdXJhbCA9ICdkaXNjdXNzaW9ucyc7CiAgRGlzY3Vzc2lvbk1vZGVsLnVuaXF1ZUluZGljZXMgPSBbJ2lkJywgJ2tleSddOwogIERpc2N1c3Npb25Nb2RlbC5pbmRpY2VzID0gWydncm91cElkJywgJ2F1dGhvcklkJ107CiAgRGlzY3Vzc2lvbk1vZGVsLnByb3RvdHlwZS51cGRhdGVSZWFkUmFuZ2VzID0gX3Rocm90dGxlKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLnJlbW90ZS5wYXRjaE1lbWJlcih0aGlzLmtleU9ySWQoKSwgJ21hcmtfYXNfcmVhZCcsIHsKICAgICAgcmFuZ2VzOiBSYW5nZVNldC5zZXJpYWxpemUodGhpcy5yZWFkUmFuZ2VzKQogICAgfSk7CiAgfSwgMjAwMCk7CiAgcmV0dXJuIERpc2N1c3Npb25Nb2RlbDsKfS5jYWxsKHRoaXMpOw=="},{"version":3,"sources":["/home/gustavo/Documents/tese/loomio/vue/src/shared/models/discussion_model.coffee"],"names":[],"mappings":"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","sourcesContent":["import BaseModel        from '@/shared/record_store/base_model'\nimport AppConfig        from '@/shared/services/app_config'\nimport Session          from '@/shared/services/session'\nimport RangeSet         from '@/shared/services/range_set'\nimport HasDocuments     from '@/shared/mixins/has_documents'\nimport HasTranslations  from '@/shared/mixins/has_translations'\nimport { isAfter } from 'date-fns'\nimport dateIsEqual from 'date-fns/isEqual'\nimport { map, compact, flatten, isEqual, isEmpty, filter, some, head, last, sortBy, find, min, max, isArray, throttle, without } from 'lodash'\nimport I18n from '@/i18n'\n\nexport default class DiscussionModel extends BaseModel\n  @singular: 'discussion'\n  @plural: 'discussions'\n  @uniqueIndices: ['id', 'key']\n  @indices: ['groupId', 'authorId']\n\n  afterConstruction: ->\n    @private = @privateDefaultValue() if @isNew()\n    HasDocuments.apply @, showTitle: true\n    HasTranslations.apply @\n\n  defaultValues: ->\n    id: null\n    key: null\n    private: true\n    lastItemAt: null\n    title: ''\n    description: ''\n    descriptionFormat: 'html'\n    forkedEventIds: []\n    ranges: []\n    readRanges: []\n    newestFirst: false\n    files: []\n    imageFiles: []\n    attachments: []\n    linkPreviews: []\n    tags: []\n    recipientMessage: null\n    recipientAudience: null\n    recipientUserIds: []\n    recipientChatbotIds: []\n    recipientEmails: []\n    notifyRecipients: true\n    groupId: null\n    usersNotifiedCount: null\n    discussionReaderUserId: null\n    pinnedAt: null\n    template: false\n\n  cloneTemplate: ->\n    clone = @clone()\n    clone.id = null\n    clone.key = null\n    clone.title = I18n.t('templates.copy_of_title', {title: clone.title})\n    clone.sourceTemplateId = @id\n    clone.authorId = Session.user().id\n    clone.pinnedAt = null\n    clone.forkedEventIds = []\n    clone.groupId = null\n    clone.closedAt = null\n    clone.createdAt = null\n    clone.updatedAt = null\n    clone.template = false\n    clone\n\n  audienceValues: ->\n    name: @group().name\n\n  privateDefaultValue: =>\n    @group().discussionPrivacyOptions != 'public_only'\n\n  relationships: ->\n    @hasMany 'polls', sortBy: 'createdAt', sortDesc: true, find: {discardedAt: null}\n    @belongsTo 'group'\n    @belongsTo 'author', from: 'users'\n    @hasMany 'discussionReaders'\n\n    # @belongsTo 'createdEvent', from: 'events'\n    # @belongsTo 'forkedEvent', from: 'events'\n\n  discussion: -> @\n  \n  sourceTemplate: ->\n    @recordStore.discussions.find(@sourceTemplateId)\n\n  tags: ->\n    @recordStore.tags.collection.chain().find(id: {$in: @tagIds}).simplesort('priority').data()\n\n  members: ->\n    @recordStore.users.find(@group().memberIds().concat(map(@discussionReaders(), 'userId')))\n\n  membersInclude: (user) ->\n    (@inviterId && !@revokedAt && Session.user().id == user.id) ||\n    @group().membersInclude(user)\n\n  adminsInclude: (user) ->\n    @authorId == user.id ||\n    (@inviterId && @admin && !@revokedAt && AppConfig.currentUserId == user.id) ||\n    @group().adminsInclude(user)\n\n  # known current participants for quick mentioning\n  participantIds: ->\n    compact flatten(\n      map(@recordStore.comments.find(discussionId: @id), 'authorId'),\n      map(@recordStore.polls.find(discussionId: @id), (p) -> p.participantIds()),\n      [@authorId]\n    )\n\n  bestNamedId: ->\n    ((@id && @) || (@groupId && @group()) || {namedId: ->}).namedId()\n\n  createdEvent: ->\n    res = @recordStore.events.find(kind: 'new_discussion', eventableId: @id)\n    res[0] unless isEmpty(res)\n\n  forkedEvent: ->\n    res = @recordStore.events.find(kind: 'discussion_forked', eventableId: @id)\n    res[0] unless isEmpty(res)\n\n  reactions: ->\n    @recordStore.reactions.find(reactableId: @id, reactableType: \"Discussion\")\n\n  translationOptions: ->\n    title: @title\n    groupName: @groupName()\n\n  authorName: ->\n    @author().nameWithTitle(@group())\n\n  isBlank: ->\n    @description == '' or @description == null or @description == '<p></p>'\n\n  groupName: ->\n    (@group() || {}).name\n\n  activePolls: ->\n    filter @polls(), (poll) ->\n      poll.isVotable()\n\n  hasActivePoll: ->\n    some @activePolls()\n\n  hasDecision: ->\n    @hasActivePoll()\n\n  closedPolls: ->\n    filter @polls(), (poll) ->\n      !poll.isVotable()\n\n  activePoll: ->\n    head @activePolls()\n\n  isUnread: ->\n    !@isDismissed() and (!@lastReadAt? or @unreadItemsCount() > 0)\n\n  isDismissed: ->\n    @discussionReaderId? and @dismissedAt? and\n    (dateIsEqual(@dismissedAt, @lastActivityAt) or isAfter(@dismissedAt, @lastActivityAt))\n\n  hasUnreadActivity: ->\n    @isUnread() && @unreadItemsCount() > 0\n\n  membership: ->\n    @recordStore.memberships.find(userId: AppConfig.currentUserId, groupId: @groupId)[0]\n\n  volume: -> @discussionReaderVolume\n\n  saveVolume: (volume, applyToAll = false) =>\n    @processing = true\n    if applyToAll\n      @membership().saveVolume(volume).finally => @processing = false\n    else\n      @discussionReaderVolume = volume if volume?\n      @remote.patchMember(@keyOrId(), 'set_volume', { volume: @discussionReaderVolume }).finally =>\n        @processing = false\n\n  isMuted: ->\n    @volume() == 'mute'\n\n  markAsSeen: ->\n    return if @lastReadAt\n    @remote.patchMember @keyOrId(), 'mark_as_seen'\n    @update(lastReadAt: new Date)\n\n  markAsRead: (id) ->\n    return if @hasRead(id)\n    @readRanges.push([id,id])\n    @readRanges = RangeSet.reduce(@readRanges)\n    @updateReadRanges()\n\n  update: (attributes) ->\n    if isArray(@readRanges) && isArray(attributes.readRanges) && !isEqual(attributes.readRanges, @readRanges)\n      attributes.readRanges = RangeSet.reduce(@readRanges.concat(attributes.readRanges))\n    @baseUpdate(attributes)\n    @readRanges = RangeSet.intersectRanges(@readRanges, @ranges)\n\n  updateReadRanges: throttle ->\n    @remote.patchMember @keyOrId(), 'mark_as_read', ranges: RangeSet.serialize(@readRanges)\n  , 2000\n\n  hasRead: (id) ->\n    RangeSet.includesValue(@readRanges, id)\n\n  unreadItemsCount: ->\n    @itemsCount - @readItemsCount()\n\n  readItemsCount: ->\n    RangeSet.length(@readRanges)\n\n  firstSequenceId: ->\n    (head(@ranges) || [])[0]\n\n  lastSequenceId: ->\n    (last(@ranges) || [])[1]\n\n  lastReadSequenceId: ->\n    (last(@readRanges) || [])[1]\n\n  firstUnreadSequenceId: ->\n    (@unreadRanges()[0] || [])[0]\n\n  readSequenceIds: ->\n    RangeSet.rangesToArray(@readRanges)\n\n  unreadRanges: ->\n    RangeSet.subtractRanges(@ranges, @readRanges)\n\n  unreadSequenceIds: ->\n    RangeSet.rangesToArray(@unreadRanges())\n\n  dismiss: ->\n    @update(dismissedAt: new Date)\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'dismiss').finally => @processing = false\n\n  recall: ->\n    @update(dismissedAt: null)\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'recall').finally => @processing = false\n\n  move: =>\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'move', { group_id: @groupId }).finally => @processing = false\n\n  savePin: =>\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'pin').finally => @processing = false\n\n  saveUnpin: =>\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'unpin').finally => @processing = false\n\n  close: =>\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'close').finally => @processing = false\n\n  reopen: =>\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'reopen').finally => @processing = false\n\n  fork: =>\n    @processing = true\n    @remote.post('fork', @serialize()).finally => @processing = false\n\n  moveComments: =>\n    @processing = true\n    @remote.patchMember(@keyOrId(), 'move_comments', { forked_event_ids: @forkedEventIds }).finally => @processing = false\n\n  fetchUsersNotifiedCount: ->\n    @recordStore.fetch\n      path: 'announcements/users_notified_count'\n      params:\n        discussion_id: @id\n    .then (data) =>\n      @usersNotifiedCount = data.count\n\n  forkedEvents: ->\n    sortBy(@recordStore.events.find(@forkedEventIds), 'sequenceId')\n\n  forkTarget: ->\n    @forkedEvents()[0].model() if some @forkedEvents()\n"],"sourceRoot":""}]}